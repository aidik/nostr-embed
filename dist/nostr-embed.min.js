!function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let s,a;function c(t,e){return t===e||(s||(s=document.createElement("a")),s.href=e,t===s.href)}function u(t,e){t.appendChild(e)}function l(t,e,n){const r=function(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;if(e&&e.host)return e;return t.ownerDocument}(t);if(!r.getElementById(e)){const t=d("style");t.id=e,t.textContent=n,function(t,e){u(t.head||t,e),e.sheet}(r,t)}}function f(t,e,n){t.insertBefore(e,n||null)}function h(t){t.parentNode&&t.parentNode.removeChild(t)}function d(t){return document.createElement(t)}function p(t){return document.createTextNode(t)}function g(){return p(" ")}function y(){return p("")}function w(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e,n){const r=e.toLowerCase();r in t?t[r]="boolean"==typeof t[r]&&""===n||n:e in t?t[e]="boolean"==typeof t[e]&&""===n||n:w(t,e,n)}function m(t,e){e=""+e,t.data!==e&&(t.data=e)}function E(t,e,n,r){t.style.setProperty(e,n,"")}function v(t,e,n){t.classList.toggle(e,!!n)}function $(t){a=t}const x=[],A=[];let k=[];const S=[],B=Promise.resolve();let _=!1;function I(t){k.push(t)}const O=new Set;let L=0;function U(){if(0!==L)return;const t=a;do{try{for(;L<x.length;){const t=x[L];L++,$(t),R(t.$$)}}catch(t){throw x.length=0,L=0,t}for($(null),x.length=0,L=0;A.length;)A.pop()();for(let t=0;t<k.length;t+=1){const e=k[t];O.has(e)||(O.add(e),e())}k.length=0}while(x.length);for(;S.length;)S.pop()();_=!1,O.clear(),$(t)}function R(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(I)}}const T=new Set;function N(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];k.forEach((r=>-1===t.indexOf(r)?e.push(r):n.push(r))),n.forEach((t=>t())),k=e}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function P(t,e){-1===t.$$.dirty[0]&&(x.push(t),_||(_=!0,B.then(U)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function C(i,s,c,u,l,f,d=null,p=[-1]){const g=a;$(i);const y=i.$$={fragment:null,ctx:[],props:f,update:t,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(s.context||(g?g.$$.context:[])),callbacks:n(),dirty:p,skip_bound:!1,root:s.target||g.$$.root};d&&d(y.root);let w=!1;if(y.ctx=c?c(i,s.props||{},((t,e,...n)=>{const r=n.length?n[0]:e;return y.ctx&&l(y.ctx[t],y.ctx[t]=r)&&(!y.skip_bound&&y.bound[t]&&y.bound[t](r),w&&P(i,t)),e})):[],y.update(),w=!0,r(y.before_update),y.fragment=!!u&&u(y.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);y.fragment&&y.fragment.l(t),t.forEach(h)}else y.fragment&&y.fragment.c();s.intro&&((b=i.$$.fragment)&&b.i&&(T.delete(b),b.i(m))),function(t,n,i){const{fragment:s,after_update:a}=t.$$;s&&s.m(n,i),I((()=>{const n=t.$$.on_mount.map(e).filter(o);t.$$.on_destroy?t.$$.on_destroy.push(...n):r(n),t.$$.on_mount=[]})),a.forEach(I)}(i,s.target,s.anchor),U()}var b,m;$(g)}let H;function q(t,e,n,r){const o=n[t]?.type;if(e="Boolean"===o&&"boolean"!=typeof e?null!=e:e,!r||!n[t])return e;if("toAttribute"===r)switch(o){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(o){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}function D(t,e,n,r,o,i){let s=class extends H{constructor(){super(t,n,o),this.$$p_d=e}static get observedAttributes(){return Object.keys(e).map((t=>(e[t].attribute||t).toLowerCase()))}};return Object.keys(e).forEach((t=>{Object.defineProperty(s.prototype,t,{get(){return this.$$c&&t in this.$$c?this.$$c[t]:this.$$d[t]},set(n){n=q(t,n,e),this.$$d[t]=n,this.$$c?.$set({[t]:n})}})})),r.forEach((t=>{Object.defineProperty(s.prototype,t,{get(){return this.$$c?.[t]}})})),t.element=s,s}"function"==typeof HTMLElement&&(H=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;constructor(t,e,n){super(),this.$$ctor=t,this.$$s=e,n&&this.attachShadow({mode:"open"})}addEventListener(t,e,n){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const n=this.$$c.$on(t,e);this.$$l_u.set(e,n)}super.addEventListener(t,e,n)}removeEventListener(t,e,n){if(super.removeEventListener(t,e,n),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(t){return()=>{let e;return{c:function(){e=d("slot"),"default"!==t&&w(e,"name",t)},m:function(t,n){f(t,e,n)},d:function(t){t&&h(e)}}}}const e={},n=function(t){const e={};return t.childNodes.forEach((t=>{e[t.slot||"default"]=!0})),e}(this);for(const o of this.$$s)o in n&&(e[o]=[t(o)]);for(const i of this.attributes){const s=this.$$g_p(i.name);s in this.$$d||(this.$$d[s]=q(s,i.value,this.$$p_d,"toProp"))}for(const a in this.$$p_d)a in this.$$d||void 0===this[a]||(this.$$d[a]=this[a],delete this[a]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$scope:{ctx:[]}}});const r=()=>{this.$$r=!0;for(const t in this.$$p_d)if(this.$$d[t]=this.$$c.$$.ctx[this.$$c.$$.props[t]],this.$$p_d[t].reflect){const e=q(t,this.$$d[t],this.$$p_d,"toAttribute");null==e?this.removeAttribute(this.$$p_d[t].attribute||t):this.setAttribute(this.$$p_d[t].attribute||t,e)}this.$$r=!1};this.$$c.$$.after_update.push(r),r();for(const c in this.$$l)for(const u of this.$$l[c]){const l=this.$$c.$on(c,u);this.$$l_u.set(u,l)}this.$$l={}}}attributeChangedCallback(t,e,n){this.$$r||(t=this.$$g_p(t),this.$$d[t]=q(t,n,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then((()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$c=void 0)}))}$$g_p(t){return Object.keys(this.$$p_d).find((e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t))||t}});class M{$$=void 0;$$set=void 0;$destroy(){N(this,1),this.$destroy=t}$on(e,n){if(!o(n))return t;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const t=r.indexOf(n);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function j(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function F(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function z(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const V="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,K=t=>t instanceof Uint8Array,W=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Z=(t,e)=>t<<32-e|t>>>e;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function J(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!K(t))throw new Error("expected Uint8Array, got "+typeof t);return t}let G=class{clone(){return this._cloneInto()}};function Y(t){const e=e=>t().update(J(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Q(t=32){if(V&&"function"==typeof V.getRandomValues)return V.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}let X=class extends G{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=W(this.buffer)}update(t){z(this);const{view:e,buffer:n,blockLen:r}=this,o=(t=J(t)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=W(t);for(;r<=o-i;i+=r)this.process(e,i)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){z(this),function(t,e){F(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let t=i;t<r;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=W(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return t.length=r,t.pos=s,t.finished=o,t.destroyed=i,r%e&&t.buffer.set(n),t}};const tt=(t,e,n)=>t&e^t&n^e&n,et=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),nt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),rt=new Uint32Array(64);let ot=class extends X{constructor(){super(64,32,8,!1),this.A=0|nt[0],this.B=0|nt[1],this.C=0|nt[2],this.D=0|nt[3],this.E=0|nt[4],this.F=0|nt[5],this.G=0|nt[6],this.H=0|nt[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[t,e,n,r,o,i,s,a]}set(t,e,n,r,o,i,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)rt[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=rt[t-15],n=rt[t-2],r=Z(e,7)^Z(e,18)^e>>>3,o=Z(n,17)^Z(n,19)^n>>>10;rt[t]=o+rt[t-7]+r+rt[t-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Z(s,6)^Z(s,11)^Z(s,25))+((l=s)&a^~l&c)+et[t]+rt[t]|0,f=(Z(n,2)^Z(n,13)^Z(n,22))+tt(n,r,o)|0;u=c,c=a,a=s,s=i+e|0,i=o,o=r,r=n,n=e+f|0}var l;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){rt.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const it=Y((()=>new ot)),st=BigInt(0),at=BigInt(1),ct=BigInt(2),ut=t=>t instanceof Uint8Array,lt=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ft(t){if(!ut(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=lt[t[n]];return e}function ht(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function dt(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function pt(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[e]=i}return n}function gt(t){return dt(ft(t))}function yt(t){if(!ut(t))throw new Error("Uint8Array expected");return dt(ft(Uint8Array.from(t).reverse()))}function wt(t,e){return pt(t.toString(16).padStart(2*e,"0"))}function bt(t,e){return wt(t,e).reverse()}function mt(t,e,n){let r;if("string"==typeof e)try{r=pt(e)}catch(n){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${n}`)}else{if(!ut(e))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const o=r.length;if("number"==typeof n&&o!==n)throw new Error(`${t} expected ${n} bytes, got ${o}`);return r}function Et(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let n=0;return t.forEach((t=>{if(!ut(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length})),e}const vt=t=>(ct<<BigInt(t-1))-at,$t=t=>new Uint8Array(t),xt=t=>Uint8Array.from(t);function At(t,e,n){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=$t(t),o=$t(t),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...t)=>n(o,r,...t),c=(t=$t())=>{o=a(xt([0]),t),r=a(),0!==t.length&&(o=a(xt([1]),t),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const n=[];for(;t<e;){r=a();const e=r.slice();n.push(e),t+=r.length}return Et(...n)};return(t,e)=>{let n;for(s(),c(t);!(n=e(u()));)c();return s(),n}}const kt={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function St(t,e,n={}){const r=(e,n,r)=>{const o=kt[n];if("function"!=typeof o)throw new Error(`Invalid validator "${n}", expected function`);const i=t[e];if(!(r&&void 0===i||o(i,t)))throw new Error(`Invalid param ${String(e)}=${i} (${typeof i}), expected ${n}`)};for(const[t,n]of Object.entries(e))r(t,n,!1);for(const[t,e]of Object.entries(n))r(t,e,!0);return t}var Bt=Object.freeze({__proto__:null,bitGet:function(t,e){return t>>BigInt(e)&at},bitLen:function(t){let e;for(e=0;t>st;t>>=at,e+=1);return e},bitMask:vt,bitSet:(t,e,n)=>t|(n?at:st)<<BigInt(e),bytesToHex:ft,bytesToNumberBE:gt,bytesToNumberLE:yt,concatBytes:Et,createHmacDrbg:At,ensureBytes:mt,equalBytes:function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0},hexToBytes:pt,hexToNumber:dt,numberToBytesBE:wt,numberToBytesLE:bt,numberToHexUnpadded:ht,numberToVarBytesBE:function(t){return pt(ht(t))},utf8ToBytes:function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))},validateObject:St});
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _t=BigInt(0),It=BigInt(1),Ot=BigInt(2),Lt=BigInt(3),Ut=BigInt(4),Rt=BigInt(5),Tt=BigInt(8);function Nt(t,e){const n=t%e;return n>=_t?n:e+n}function Pt(t,e,n){if(n<=_t||e<_t)throw new Error("Expected power/modulo > 0");if(n===It)return _t;let r=It;for(;e>_t;)e&It&&(r=r*t%n),t=t*t%n,e>>=It;return r}function Ct(t,e,n){let r=t;for(;e-- >_t;)r*=r,r%=n;return r}function Ht(t,e){if(t===_t||e<=_t)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=Nt(t,e),r=e,o=_t,i=It;for(;n!==_t;){const t=r%n,e=o-i*(r/n);r=n,n=t,o=i,i=e}if(r!==It)throw new Error("invert: does not exist");return Nt(o,e)}function qt(t){if(t%Ut===Lt){const e=(t+It)/Ut;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}if(t%Tt===Rt){const e=(t-Rt)/Tt;return function(t,n){const r=t.mul(n,Ot),o=t.pow(r,e),i=t.mul(n,o),s=t.mul(t.mul(i,Ot),o),a=t.mul(i,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),n))throw new Error("Cannot find square root");return a}}return function(t){const e=(t-It)/Ot;let n,r,o;for(n=t-It,r=0;n%Ot===_t;n/=Ot,r++);for(o=Ot;o<t&&Pt(o,e,t)!==t-It;o++);if(1===r){const e=(t+It)/Ut;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}const i=(n+It)/Ot;return function(t,s){if(t.pow(s,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let a=r,c=t.pow(t.mul(t.ONE,o),n),u=t.pow(s,i),l=t.pow(s,n);for(;!t.eql(l,t.ONE);){if(t.eql(l,t.ZERO))return t.ZERO;let e=1;for(let n=t.sqr(l);e<a&&!t.eql(n,t.ONE);e++)n=t.sqr(n);const n=t.pow(c,It<<BigInt(a-e-1));c=t.sqr(n),u=t.mul(u,n),l=t.mul(l,c),a=e}return u}}(t)}BigInt(9),BigInt(16);const Dt=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Mt(t,e){const n=void 0!==e?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function jt(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Ft(t){const e=jt(t);return e+Math.ceil(e/2)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const zt=BigInt(0),Vt=BigInt(1);function Kt(t){return St(t.Fp,Dt.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),St(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Mt(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const{bytesToNumberBE:Wt,hexToBytes:Zt}=Bt,Jt={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=Jt;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");const n=t[1],r=t.subarray(2,n+2);if(!n||r.length!==n)throw new e("Invalid signature integer: wrong length");if(128&r[0])throw new e("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Wt(r),l:t.subarray(n+2)}},toSig(t){const{Err:e}=Jt,n="string"==typeof t?Zt(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new e("Invalid signature tag");if(n[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:o,l:i}=Jt._parseInt(n.subarray(2)),{d:s,l:a}=Jt._parseInt(i);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:o,s:s}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,n=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},r=e(n(t.s)),o=e(n(t.r)),i=r.length/2,s=o.length/2,a=n(i),c=n(s);return`30${n(s+i+4)}02${c}${o}02${a}${r}`}},Gt=BigInt(0),Yt=BigInt(1);BigInt(2);const Qt=BigInt(3);function Xt(t){const e=function(t){const e=Kt(t);St(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=e;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:n}=e,r=e.toBytes||((t,e,r)=>{const o=e.toAffine();return Et(Uint8Array.from([4]),n.toBytes(o.x),n.toBytes(o.y))}),o=e.fromBytes||(t=>{const e=t.subarray(1);return{x:n.fromBytes(e.subarray(0,n.BYTES)),y:n.fromBytes(e.subarray(n.BYTES,2*n.BYTES))}});function i(t){const{a:r,b:o}=e,i=n.sqr(t),s=n.mul(i,t);return n.add(n.add(s,n.mul(t,r)),o)}if(!n.eql(n.sqr(e.Gy),i(e.Gx)))throw new Error("bad generator point: equation left != right");function s(t){return"bigint"==typeof t&&Gt<t&&t<e.n}function a(t){if(!s(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(t){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:o,n:i}=e;if(n&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=ft(t)),"string"!=typeof t||!n.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*r,"0")}let s;try{s="bigint"==typeof t?t:gt(mt("private key",t,r))}catch(e){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof t}`)}return o&&(s=Nt(s,i)),a(s),s}const u=new Map;function l(t){if(!(t instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!n.isValid(t))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof f)throw new Error("projective point not allowed");const o=t=>n.eql(t,n.ZERO);return o(e)&&o(r)?f.ZERO:new f(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=n.invertBatch(t.map((t=>t.pz)));return t.map(((t,n)=>t.toAffine(e[n]))).map(f.fromAffine)}static fromHex(t){const e=f.fromAffine(o(mt("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return f.BASE.multiply(c(t))}_setWindowSize(t){this._WINDOW_SIZE=t,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:t,y:r}=this.toAffine();if(!n.isValid(t)||!n.isValid(r))throw new Error("bad point: x or y not FE");const o=n.sqr(r),s=i(t);if(!n.eql(o,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){l(t);const{px:e,py:r,pz:o}=this,{px:i,py:s,pz:a}=t,c=n.eql(n.mul(e,a),n.mul(i,o)),u=n.eql(n.mul(r,a),n.mul(s,o));return c&&u}negate(){return new f(this.px,n.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,o=n.mul(r,Qt),{px:i,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,h=n.mul(i,i),d=n.mul(s,s),p=n.mul(a,a),g=n.mul(i,s);return g=n.add(g,g),l=n.mul(i,a),l=n.add(l,l),c=n.mul(t,l),u=n.mul(o,p),u=n.add(c,u),c=n.sub(d,u),u=n.add(d,u),u=n.mul(c,u),c=n.mul(g,c),l=n.mul(o,l),p=n.mul(t,p),g=n.sub(h,p),g=n.mul(t,g),g=n.add(g,l),l=n.add(h,h),h=n.add(l,h),h=n.add(h,p),h=n.mul(h,g),u=n.add(u,h),p=n.mul(s,a),p=n.add(p,p),h=n.mul(p,g),c=n.sub(c,h),l=n.mul(p,d),l=n.add(l,l),l=n.add(l,l),new f(c,u,l)}add(t){l(t);const{px:r,py:o,pz:i}=this,{px:s,py:a,pz:c}=t;let u=n.ZERO,h=n.ZERO,d=n.ZERO;const p=e.a,g=n.mul(e.b,Qt);let y=n.mul(r,s),w=n.mul(o,a),b=n.mul(i,c),m=n.add(r,o),E=n.add(s,a);m=n.mul(m,E),E=n.add(y,w),m=n.sub(m,E),E=n.add(r,i);let v=n.add(s,c);return E=n.mul(E,v),v=n.add(y,b),E=n.sub(E,v),v=n.add(o,i),u=n.add(a,c),v=n.mul(v,u),u=n.add(w,b),v=n.sub(v,u),d=n.mul(p,E),u=n.mul(g,b),d=n.add(u,d),u=n.sub(w,d),d=n.add(w,d),h=n.mul(u,d),w=n.add(y,y),w=n.add(w,y),b=n.mul(p,b),E=n.mul(g,E),w=n.add(w,b),b=n.sub(y,b),b=n.mul(p,b),E=n.add(E,b),y=n.mul(w,E),h=n.add(h,y),y=n.mul(v,E),u=n.mul(m,u),u=n.sub(u,y),y=n.mul(m,w),d=n.mul(v,d),d=n.add(d,y),new f(u,h,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(f.ZERO)}wNAF(t){return d.wNAFCached(this,u,t,(t=>{const e=n.invertBatch(t.map((t=>t.pz)));return t.map(((t,n)=>t.toAffine(e[n]))).map(f.fromAffine)}))}multiplyUnsafe(t){const r=f.ZERO;if(t===Gt)return r;if(a(t),t===Yt)return this;const{endo:o}=e;if(!o)return d.unsafeLadder(this,t);let{k1neg:i,k1:s,k2neg:c,k2:u}=o.splitScalar(t),l=r,h=r,p=this;for(;s>Gt||u>Gt;)s&Yt&&(l=l.add(p)),u&Yt&&(h=h.add(p)),p=p.double(),s>>=Yt,u>>=Yt;return i&&(l=l.negate()),c&&(h=h.negate()),h=new f(n.mul(h.px,o.beta),h.py,h.pz),l.add(h)}multiply(t){a(t);let r,o,i=t;const{endo:s}=e;if(s){const{k1neg:t,k1:e,k2neg:a,k2:c}=s.splitScalar(i);let{p:u,f:l}=this.wNAF(e),{p:h,f:p}=this.wNAF(c);u=d.constTimeNegate(t,u),h=d.constTimeNegate(a,h),h=new f(n.mul(h.px,s.beta),h.py,h.pz),r=u.add(h),o=l.add(p)}else{const{p:t,f:e}=this.wNAF(i);r=t,o=e}return f.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(t,e,n){const r=f.BASE,o=(t,e)=>e!==Gt&&e!==Yt&&t.equals(r)?t.multiply(e):t.multiplyUnsafe(e),i=o(this,e).add(o(t,n));return i.is0()?void 0:i}toAffine(t){const{px:e,py:r,pz:o}=this,i=this.is0();null==t&&(t=i?n.ONE:n.inv(o));const s=n.mul(e,t),a=n.mul(r,t),c=n.mul(o,t);if(i)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:t,isTorsionFree:n}=e;if(t===Yt)return!0;if(n)return n(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:n}=e;return t===Yt?this:n?n(f,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),r(f,this,t)}toHex(t=!0){return ft(this.toRawBytes(t))}}f.BASE=new f(e.Gx,e.Gy,n.ONE),f.ZERO=new f(n.ZERO,n.ONE,n.ZERO);const h=e.nBitLength,d=function(t,e){const n=(t,e)=>{const n=e.negate();return t?n:e},r=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:n,unsafeLadder(e,n){let r=t.ZERO,o=e;for(;n>zt;)n&Vt&&(r=r.add(o)),o=o.double(),n>>=Vt;return r},precomputeWindow(t,e){const{windows:n,windowSize:o}=r(e),i=[];let s=t,a=s;for(let t=0;t<n;t++){a=s,i.push(a);for(let t=1;t<o;t++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(e,o,i){const{windows:s,windowSize:a}=r(e);let c=t.ZERO,u=t.BASE;const l=BigInt(2**e-1),f=2**e,h=BigInt(e);for(let t=0;t<s;t++){const e=t*a;let r=Number(i&l);i>>=h,r>a&&(r-=f,i+=Vt);const s=e,d=e+Math.abs(r)-1,p=t%2!=0,g=r<0;0===r?u=u.add(n(p,o[s])):c=c.add(n(g,o[d]))}return{p:c,f:u}},wNAFCached(t,e,n,r){const o=t._WINDOW_SIZE||1;let i=e.get(t);return i||(i=this.precomputeWindow(t,o),1!==o&&e.set(t,r(i))),this.wNAF(o,i,n)}}}(f,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:s}}function te(t){const e=function(t){const e=Kt(t);return St(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:n,n:r}=e,o=n.BYTES+1,i=2*n.BYTES+1;function s(t){return Nt(t,r)}function a(t){return Ht(t,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:f}=Xt({...e,toBytes(t,e,r){const o=e.toAffine(),i=n.toBytes(o.x),s=Et;return r?s(Uint8Array.from([e.hasEvenY()?2:3]),i):s(Uint8Array.from([4]),i,n.toBytes(o.y))},fromBytes(t){const e=t.length,r=t[0],s=t.subarray(1);if(e!==o||2!==r&&3!==r){if(e===i&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error(`Point of length ${e} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}{const t=gt(s);if(!(Gt<(a=t)&&a<n.ORDER))throw new Error("Point is not on curve");const e=l(t);let o=n.sqrt(e);return!(1&~r)!==((o&Yt)===Yt)&&(o=n.neg(o)),{x:t,y:o}}var a}}),h=t=>ft(wt(t,e.nByteLength));function d(t){return t>r>>Yt}const p=(t,e,n)=>gt(t.slice(e,n));class g{constructor(t,e,n){this.r=t,this.s=e,this.recovery=n,this.assertValidity()}static fromCompact(t){const n=e.nByteLength;return t=mt("compactSignature",t,2*n),new g(p(t,0,n),p(t,n,2*n))}static fromDER(t){const{r:e,s:n}=Jt.toSig(mt("DER",t));return new g(e,n)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new g(this.r,this.s,t)}recoverPublicKey(t){const{r:r,s:o,recovery:i}=this,u=m(mt("msgHash",t));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const l=2===i||3===i?r+e.n:r;if(l>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const f=1&i?"03":"02",d=c.fromHex(f+h(l)),p=a(l),g=s(-u*p),y=s(o*p),w=c.BASE.multiplyAndAddUnsafe(d,g,y);if(!w)throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return pt(this.toDERHex())}toDERHex(){return Jt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return pt(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const y={isValidPrivateKey(t){try{return u(t),!0}catch(t){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const t=Ft(e.n);return function(t,e,n=!1){const r=t.length,o=jt(e),i=Ft(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const s=Nt(n?gt(t):yt(t),e-It)+It;return n?bt(s,o):wt(s,o)}(e.randomBytes(t),e.n)},precompute:(t=8,e=c.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function w(t){const e=t instanceof Uint8Array,n="string"==typeof t,r=(e||n)&&t.length;return e?r===o||r===i:n?r===2*o||r===2*i:t instanceof c}const b=e.bits2int||function(t){const n=gt(t),r=8*t.length-e.nBitLength;return r>0?n>>BigInt(r):n},m=e.bits2int_modN||function(t){return s(b(t))},E=vt(e.nBitLength);function v(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(Gt<=t&&t<E))throw new Error(`bigint expected < 2^${e.nBitLength}`);return wt(t,e.nByteLength)}function $(t,r,o=x){if(["recovered","canonical"].some((t=>t in o)))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:l}=e;let{lowS:h,prehash:p,extraEntropy:y}=o;null==h&&(h=!0),t=mt("msgHash",t),p&&(t=mt("prehashed msgHash",i(t)));const w=m(t),E=u(r),$=[v(E),v(w)];if(null!=y){const t=!0===y?l(n.BYTES):y;$.push(mt("extraEntropy",t))}const A=Et(...$),k=w;return{seed:A,k2sig:function(t){const e=b(t);if(!f(e))return;const n=a(e),r=c.BASE.multiply(e).toAffine(),o=s(r.x);if(o===Gt)return;const i=s(n*s(k+o*E));if(i===Gt)return;let u=(r.x===o?0:2)|Number(r.y&Yt),l=i;return h&&d(i)&&(l=function(t){return d(t)?s(-t):t}(i),u^=1),new g(o,l,u)}}}const x={lowS:e.lowS,prehash:!1},A={lowS:e.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return c.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,n=!0){if(w(t))throw new Error("first arg must be private key");if(!w(e))throw new Error("second arg must be public key");return c.fromHex(e).multiply(u(t)).toRawBytes(n)},sign:function(t,n,r=x){const{seed:o,k2sig:i}=$(t,n,r),s=e;return At(s.hash.outputLen,s.nByteLength,s.hmac)(o,i)},verify:function(t,n,r,o=A){const i=t;if(n=mt("msgHash",n),r=mt("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:l}=o;let f,h;try{if("string"==typeof i||i instanceof Uint8Array)try{f=g.fromDER(i)}catch(t){if(!(t instanceof Jt.Err))throw t;f=g.fromCompact(i)}else{if("object"!=typeof i||"bigint"!=typeof i.r||"bigint"!=typeof i.s)throw new Error("PARSE");{const{r:t,s:e}=i;f=new g(t,e)}}h=c.fromHex(r)}catch(t){if("PARSE"===t.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&f.hasHighS())return!1;l&&(n=e.hash(n));const{r:d,s:p}=f,y=m(n),w=a(p),b=s(y*w),E=s(d*w),v=c.BASE.multiplyAndAddUnsafe(h,b,E)?.toAffine();return!!v&&s(v.x)===d},ProjectivePoint:c,Signature:g,utils:y}}BigInt(4);let ee=class extends G{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");j(t.outputLen),j(t.blockLen)}(t);const n=J(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let t=0;t<o.length;t++)o[t]^=54;this.iHash.update(o),this.oHash=t.create();for(let t=0;t<o.length;t++)o[t]^=106;this.oHash.update(o),o.fill(0)}update(t){return z(this),this.iHash.update(t),this}digestInto(t){z(this),F(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return t.finished=r,t.destroyed=o,t.blockLen=i,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const ne=(t,e,n)=>new ee(t,e).update(n).digest();
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function re(t){return{hash:t,hmac:(e,...n)=>ne(t,e,function(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let n=0;return t.forEach((t=>{if(!K(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length})),e}(...n)),randomBytes:Q}}ne.create=(t,e)=>new ee(t,e);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const oe=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ie=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),se=BigInt(1),ae=BigInt(2),ce=(t,e)=>(t+e/ae)/e;function ue(t){const e=oe,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),u=t*t*t%e,l=u*u*t%e,f=Ct(l,n,e)*l%e,h=Ct(f,n,e)*l%e,d=Ct(h,ae,e)*u%e,p=Ct(d,o,e)*d%e,g=Ct(p,i,e)*p%e,y=Ct(g,a,e)*g%e,w=Ct(y,c,e)*y%e,b=Ct(w,a,e)*g%e,m=Ct(b,n,e)*l%e,E=Ct(m,s,e)*p%e,v=Ct(E,r,e)*u%e,$=Ct(v,ae,e);if(!le.eql(le.sqr($),t))throw new Error("Cannot find square root");return $}const le=function(t,e,n=!1,r={}){if(t<=_t)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:i}=Mt(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=qt(t),a=Object.freeze({ORDER:t,BITS:o,BYTES:i,MASK:vt(o),ZERO:_t,ONE:It,create:e=>Nt(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return _t<=e&&e<t},is0:t=>t===_t,isOdd:t=>(t&It)===It,neg:e=>Nt(-e,t),eql:(t,e)=>t===e,sqr:e=>Nt(e*e,t),add:(e,n)=>Nt(e+n,t),sub:(e,n)=>Nt(e-n,t),mul:(e,n)=>Nt(e*n,t),pow:(t,e)=>function(t,e,n){if(n<_t)throw new Error("Expected power > 0");if(n===_t)return t.ONE;if(n===It)return e;let r=t.ONE,o=e;for(;n>_t;)n&It&&(r=t.mul(r,o)),o=t.sqr(o),n>>=It;return r}(a,t,e),div:(e,n)=>Nt(e*Ht(n,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>Ht(e,t),sqrt:r.sqrt||(t=>s(a,t)),invertBatch:t=>function(t,e){const n=new Array(e.length),r=e.reduce(((e,r,o)=>t.is0(r)?e:(n[o]=e,t.mul(e,r))),t.ONE),o=t.inv(r);return e.reduceRight(((e,r,o)=>t.is0(r)?e:(n[o]=t.mul(e,n[o]),t.mul(e,r))),o),n}(a,t),cmov:(t,e,n)=>n?e:t,toBytes:t=>n?bt(t,i):wt(t,i),fromBytes:t=>{if(t.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${t.length}`);return n?yt(t):gt(t)}});return Object.freeze(a)}(oe,void 0,void 0,{sqrt:ue}),fe=function(t,e){const n=e=>te({...t,...re(e)});return Object.freeze({...n(e),create:n})}({a:BigInt(0),b:BigInt(7),Fp:le,n:ie,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=ie,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-se*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=ce(i*t,e),c=ce(-r*t,e);let u=Nt(t-a*n-c*o,e),l=Nt(-a*r-c*i,e);const f=u>s,h=l>s;if(f&&(u=e-u),h&&(l=e-l),u>s||l>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:f,k1:u,k2neg:h,k2:l}}}},it),he=BigInt(0),de=t=>"bigint"==typeof t&&he<t&&t<oe,pe={};function ge(t,...e){let n=pe[t];if(void 0===n){const e=it(Uint8Array.from(t,(t=>t.charCodeAt(0))));n=Et(e,e),pe[t]=n}return it(Et(n,...e))}const ye=t=>t.toRawBytes(!0).slice(1),we=t=>wt(t,32),be=t=>Nt(t,oe),me=t=>Nt(t,ie),Ee=fe.ProjectivePoint;function ve(t){let e=fe.utils.normPrivateKeyToScalar(t),n=Ee.fromPrivateKey(e);return{scalar:n.hasEvenY()?e:me(-e),bytes:ye(n)}}function $e(t){if(!de(t))throw new Error("bad x: need 0 < x < p");const e=be(t*t);let n=ue(be(e*t+BigInt(7)));n%ae!==he&&(n=be(-n));const r=new Ee(t,n,se);return r.assertValidity(),r}function xe(...t){return me(gt(ge("BIP0340/challenge",...t)))}function Ae(t){return ve(t).bytes}function ke(t,e,n=Q(32)){const r=mt("message",t),{bytes:o,scalar:i}=ve(e),s=mt("auxRand",n,32),a=we(i^gt(ge("BIP0340/aux",s))),c=ge("BIP0340/nonce",a,o,r),u=me(gt(c));if(u===he)throw new Error("sign failed: k is zero");const{bytes:l,scalar:f}=ve(u),h=xe(l,o,r),d=new Uint8Array(64);if(d.set(l,0),d.set(we(me(f+h*i)),32),!Se(d,r,o))throw new Error("sign: Invalid signature produced");return d}function Se(t,e,n){const r=mt("signature",t,64),o=mt("message",e),i=mt("publicKey",n,32);try{const t=$e(gt(i)),e=gt(r.subarray(0,32));if(!de(e))return!1;const n=gt(r.subarray(32,64));if(!("bigint"==typeof(u=n)&&he<u&&u<ie))return!1;const l=xe(we(e),ye(t),o),f=(s=t,a=n,c=me(-l),Ee.BASE.multiplyAndAddUnsafe(s,a,c));return!(!f||!f.hasEvenY()||f.toAffine().x!==e)}catch(t){return!1}var s,a,c,u}const Be=(()=>({getPublicKey:Ae,sign:ke,verify:Se,utils:{randomPrivateKey:fe.utils.randomPrivateKey,lift_x:$e,pointToBytes:ye,numberToBytesBE:wt,bytesToNumberBE:gt,taggedHash:ge,mod:Nt}}))(),_e="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,Ie=t=>t instanceof Uint8Array,Oe=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Le=(t,e)=>t<<32-e|t>>>e;if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");const Ue=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function Re(t){if(!Ie(t))throw new Error("Uint8Array expected");let e="";for(let n=0;n<t.length;n++)e+=Ue[t[n]];return e}function Te(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(e/2);for(let e=0;e<n.length;e++){const r=2*e,o=t.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[e]=i}return n}function Ne(t){if("string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),!Ie(t))throw new Error("expected Uint8Array, got "+typeof t);return t}function Pe(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let n=0;return t.forEach((t=>{if(!Ie(t))throw new Error("Uint8Array expected");e.set(t,n),n+=t.length})),e}class Ce{clone(){return this._cloneInto()}}function He(t){const e=e=>t().update(Ne(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function qe(t=32){if(_e&&"function"==typeof _e.getRandomValues)return _e.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function De(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Me(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}const je={number:De,bool:function(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:Me,hash:function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");De(t.outputLen),De(t.blockLen)},exists:function(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")},output:function(t,e){Me(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}};class Fe extends Ce{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Oe(this.buffer)}update(t){je.exists(this);const{view:e,buffer:n,blockLen:r}=this,o=(t=Ne(t)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=Oe(t);for(;r<=o-i;i+=r)this.process(e,i)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){je.exists(this),je.output(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let t=i;t<r;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=Oe(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return t.length=r,t.pos=s,t.finished=o,t.destroyed=i,r%e&&t.buffer.set(n),t}}const ze=(t,e,n)=>t&e^t&n^e&n,Ve=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ke=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),We=new Uint32Array(64);class Ze extends Fe{constructor(){super(64,32,8,!1),this.A=0|Ke[0],this.B=0|Ke[1],this.C=0|Ke[2],this.D=0|Ke[3],this.E=0|Ke[4],this.F=0|Ke[5],this.G=0|Ke[6],this.H=0|Ke[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[t,e,n,r,o,i,s,a]}set(t,e,n,r,o,i,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)We[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=We[t-15],n=We[t-2],r=Le(e,7)^Le(e,18)^e>>>3,o=Le(n,17)^Le(n,19)^n>>>10;We[t]=o+We[t-7]+r+We[t-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Le(s,6)^Le(s,11)^Le(s,25))+((l=s)&a^~l&c)+Ve[t]+We[t]|0,f=(Le(n,2)^Le(n,13)^Le(n,22))+ze(n,r,o)|0;u=c,c=a,a=s,s=i+e|0,i=o,o=r,r=n,n=e+f|0}var l;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){We.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Je extends Ze{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Ge=He((()=>new Ze));He((()=>new Je));var Ye=Symbol("verified");function Qe(t){if(!(t instanceof Object))return!1;if("number"!=typeof t.kind)return!1;if("string"!=typeof t.content)return!1;if("number"!=typeof t.created_at)return!1;if("string"!=typeof t.pubkey)return!1;if(!t.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let t=0;t<n.length;t++)if("object"==typeof n[t])return!1}return!0}new TextDecoder("utf-8");var Xe=new TextEncoder;function tn(t){-1===t.indexOf("://")&&(t="wss://"+t);let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),("80"===e.port&&"ws:"===e.protocol||"443"===e.port&&"wss:"===e.protocol)&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}var en=class{value;next=null;prev=null;constructor(t){this.value=t}},nn=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const e=new en(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const t=this.first;return this.first=null,this.last=null,t.value}const t=this.first;return this.first=t.next,t.value}};function rn(t){return Re(Ge(Xe.encode(function(t){if(!Qe(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}(t))))}var on=new class{generateSecretKey(){return Be.utils.randomPrivateKey()}getPublicKey(t){return Re(Be.getPublicKey(t))}finalizeEvent(t,e){const n=t;return n.pubkey=Re(Be.getPublicKey(e)),n.id=rn(n),n.sig=Re(Be.sign(rn(n),e)),n[Ye]=!0,n}verifyEvent(t){if("boolean"==typeof t[Ye])return t[Ye];const e=rn(t);if(e!==t.id)return t[Ye]=!1,!1;try{const n=Be.verify(t.sig,e,t.pubkey);return t[Ye]=n,n}catch(e){return t[Ye]=!1,!1}}};on.generateSecretKey,on.getPublicKey,on.finalizeEvent;var sn=on.verifyEvent;function an(t,e){if(t.ids&&-1===t.ids.indexOf(e.id))return!1;if(t.kinds&&-1===t.kinds.indexOf(e.kind))return!1;if(t.authors&&-1===t.authors.indexOf(e.pubkey))return!1;for(let n in t)if("#"===n[0]){let r=t[`#${n.slice(1)}`];if(r&&!e.tags.find((([t,e])=>t===n.slice(1)&&-1!==r.indexOf(e))))return!1}return!(t.since&&e.created_at<t.since)&&!(t.until&&e.created_at>t.until)}async function cn(){return new Promise((t=>{const e=new MessageChannel,n=()=>{e.port1.removeEventListener("message",n),t()};e.port1.addEventListener("message",n),e.port2.postMessage(0),e.port1.start()}))}var un,ln=t=>(t[Ye]=!0,!0),fn=class{url;_connected=!1;onclose=null;onnotice=t=>console.debug(`NOTICE from ${this.url}: ${t}`);_onauth=null;baseEoseTimeout=4400;connectionTimeout=4400;publishTimeout=4400;openSubs=new Map;connectionTimeoutHandle;connectionPromise;openCountRequests=new Map;openEventPublishes=new Map;ws;incomingMessageQueue=new nn;queueRunning=!1;challenge;serial=0;verifyEvent;_WebSocket;constructor(t,e){this.url=tn(t),this.verifyEvent=e.verifyEvent,this._WebSocket=e.websocketImplementation||WebSocket}static async connect(t,e){const n=new fn(t,e);return await n.connect(),n}closeAllSubscriptions(t){for(let[e,n]of this.openSubs)n.close(t);this.openSubs.clear();for(let[e,n]of this.openEventPublishes)n.reject(new Error(t));this.openEventPublishes.clear();for(let[e,n]of this.openCountRequests)n.reject(new Error(t));this.openCountRequests.clear()}get connected(){return this._connected}async connect(){return this.connectionPromise||(this.challenge=void 0,this.connectionPromise=new Promise(((t,e)=>{this.connectionTimeoutHandle=setTimeout((()=>{e("connection timed out"),this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection timed out")}),this.connectionTimeout);try{this.ws=new this._WebSocket(this.url)}catch(t){return void e(t)}this.ws.onopen=()=>{clearTimeout(this.connectionTimeoutHandle),this._connected=!0,t()},this.ws.onerror=t=>{e(t.message||"websocket error"),this._connected&&(this._connected=!1,this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection errored"))},this.ws.onclose=async()=>{this._connected&&(this._connected=!1,this.connectionPromise=void 0,this.onclose?.(),this.closeAllSubscriptions("relay connection closed"))},this.ws.onmessage=this._onmessage.bind(this)}))),this.connectionPromise}async runQueue(){for(this.queueRunning=!0;!1!==this.handleNext();)await cn();this.queueRunning=!1}handleNext(){const t=this.incomingMessageQueue.dequeue();if(!t)return!1;const e=function(t){let e=t.slice(0,22).indexOf('"EVENT"');if(-1===e)return null;let n=t.slice(e+7+1).indexOf('"');if(-1===n)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(-1===o)return null;let i=r+1+o;return t.slice(r+1,i)}(t);if(e){const n=this.openSubs.get(e);if(!n)return;const r=function(t,e){let n=e.length+3,r=t.indexOf(`"${e}":`)+n,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}(t,"id"),o=n.alreadyHaveEvent?.(r);if(n.receivedEvent?.(this,r),o)return}try{let e=JSON.parse(t);switch(e[0]){case"EVENT":{const t=this.openSubs.get(e[1]),n=e[2];return void(this.verifyEvent(n)&&function(t,e){for(let n=0;n<t.length;n++)if(an(t[n],e))return!0;return!1}(t.filters,n)&&t.onevent(n))}case"COUNT":{const t=e[1],n=e[2],r=this.openCountRequests.get(t);return void(r&&(r.resolve(n.count),this.openCountRequests.delete(t)))}case"EOSE":{const t=this.openSubs.get(e[1]);if(!t)return;return void t.receivedEose()}case"OK":{const t=e[1],n=e[2],r=e[3],o=this.openEventPublishes.get(t);return void(o&&(n?o.resolve(r):o.reject(new Error(r)),this.openEventPublishes.delete(t)))}case"CLOSED":{const t=e[1],n=this.openSubs.get(t);if(!n)return;return n.closed=!0,void n.close(e[2])}case"NOTICE":return void this.onnotice(e[1]);case"AUTH":return this.challenge=e[1],void this._onauth?.(e[1])}}catch(t){return}}async send(t){if(!this.connectionPromise)throw new Error("sending on closed connection");this.connectionPromise.then((()=>{this.ws?.send(t)}))}async auth(t){if(!this.challenge)throw new Error("can't perform auth, no challenge was received");const e=await t(function(t,e){return{kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}(this.url,this.challenge)),n=new Promise(((t,n)=>{this.openEventPublishes.set(e.id,{resolve:t,reject:n})}));return this.send('["AUTH",'+JSON.stringify(e)+"]"),n}async publish(t){const e=new Promise(((e,n)=>{this.openEventPublishes.set(t.id,{resolve:e,reject:n})}));return this.send('["EVENT",'+JSON.stringify(t)+"]"),setTimeout((()=>{const e=this.openEventPublishes.get(t.id);e&&(e.reject(new Error("publish timed out")),this.openEventPublishes.delete(t.id))}),this.publishTimeout),e}async count(t,e){this.serial++;const n=e?.id||"count:"+this.serial,r=new Promise(((t,e)=>{this.openCountRequests.set(n,{resolve:t,reject:e})}));return this.send('["COUNT","'+n+'",'+JSON.stringify(t).substring(1)),r}subscribe(t,e){const n=this.prepareSubscription(t,e);return n.fire(),n}prepareSubscription(t,e){this.serial++;const n=e.id||"sub:"+this.serial,r=new hn(this,n,t,e);return this.openSubs.set(n,r),r}close(){this.closeAllSubscriptions("relay connection closed by us"),this._connected=!1,this.ws?.close()}_onmessage(t){this.incomingMessageQueue.enqueue(t.data),this.queueRunning||this.runQueue()}},hn=class{relay;id;closed=!1;eosed=!1;filters;alreadyHaveEvent;receivedEvent;onevent;oneose;onclose;eoseTimeout;eoseTimeoutHandle;constructor(t,e,n,r){this.relay=t,this.filters=n,this.id=e,this.alreadyHaveEvent=r.alreadyHaveEvent,this.receivedEvent=r.receivedEvent,this.eoseTimeout=r.eoseTimeout||t.baseEoseTimeout,this.oneose=r.oneose,this.onclose=r.onclose,this.onevent=r.onevent||(t=>{console.warn(`onevent() callback not defined for subscription '${this.id}' in relay ${this.relay.url}. event received:`,t)})}fire(){this.relay.send('["REQ","'+this.id+'",'+JSON.stringify(this.filters).substring(1)),this.eoseTimeoutHandle=setTimeout(this.receivedEose.bind(this),this.eoseTimeout)}receivedEose(){this.eosed||(clearTimeout(this.eoseTimeoutHandle),this.eosed=!0,this.oneose?.())}close(t="closed by caller"){!this.closed&&this.relay.connected&&(this.relay.send('["CLOSE",'+JSON.stringify(this.id)+"]"),this.closed=!0),this.relay.openSubs.delete(this.id),this.onclose?.(t)}},dn=class{relays=new Map;seenOn=new Map;trackRelays=!1;verifyEvent;trustedRelayURLs=new Set;_WebSocket;constructor(t){this.verifyEvent=t.verifyEvent,this._WebSocket=t.websocketImplementation}async ensureRelay(t,e){t=tn(t);let n=this.relays.get(t);return n||(n=new fn(t,{verifyEvent:this.trustedRelayURLs.has(t)?ln:this.verifyEvent,websocketImplementation:this._WebSocket}),e?.connectionTimeout&&(n.connectionTimeout=e.connectionTimeout),this.relays.set(t,n)),await n.connect(),n}close(t){t.map(tn).forEach((t=>{this.relays.get(t)?.close()}))}subscribeMany(t,e,n){return this.subscribeManyMap(Object.fromEntries(t.map((t=>[t,e]))),n)}subscribeManyMap(t,e){this.trackRelays&&(e.receivedEvent=(t,e)=>{let n=this.seenOn.get(e);n||(n=new Set,this.seenOn.set(e,n)),n.add(t)});const n=new Set,r=[],o=Object.keys(t).length,i=[];let s=t=>{i[t]=!0,i.filter((t=>t)).length===o&&(e.oneose?.(),s=()=>{})};const a=[];let c=(t,n)=>{s(t),a[t]=n,a.filter((t=>t)).length===o&&(e.onclose?.(a),c=()=>{})};const u=t=>{if(e.alreadyHaveEvent?.(t))return!0;const r=n.has(t);return n.add(t),r},l=Promise.all(Object.entries(t).map((async(t,n,o)=>{if(o.indexOf(t)!==n)return void c(n,"duplicate url");let i,[a,l]=t;a=tn(a);try{i=await this.ensureRelay(a,{connectionTimeout:e.maxWait?Math.max(.8*e.maxWait,e.maxWait-1e3):void 0})}catch(t){return void c(n,t?.message||String(t))}let f=i.subscribe(l,{...e,oneose:()=>s(n),onclose:t=>c(n,t),alreadyHaveEvent:u,eoseTimeout:e.maxWait});r.push(f)})));return{async close(){await l,r.forEach((t=>{t.close()}))}}}subscribeManyEose(t,e,n){const r=this.subscribeMany(t,e,{...n,oneose(){r.close()}});return r}async querySync(t,e,n){return new Promise((async r=>{const o=[];this.subscribeManyEose(t,[e],{...n,onevent(t){o.push(t)},onclose(t){r(o)}})}))}async get(t,e,n){e.limit=1;const r=await this.querySync(t,e,n);return r.sort(((t,e)=>e.created_at-t.created_at)),r[0]||null}publish(t,e){return t.map(tn).map((async(t,n,r)=>{if(r.indexOf(t)!==n)return Promise.reject("duplicate url");let o=await this.ensureRelay(t);return o.publish(e).then((t=>{if(this.trackRelays){let t=this.seenOn.get(e.id);t||(t=new Set,this.seenOn.set(e.id,t)),t.add(o)}return t}))}))}listConnectionStatus(){const t=new Map;return this.relays.forEach(((e,n)=>t.set(n,e.connected))),t}destroy(){this.relays.forEach((t=>t.close())),this.relays=new Map}};try{un=WebSocket}catch{}var pn=class extends dn{constructor(){super({verifyEvent:sn,websocketImplementation:un})}};
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function gn(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function yn(...t){const e=(t,e)=>n=>t(e(n)),n=Array.from(t).reverse().reduce(((t,n)=>t?e(t,n.encode):n.encode),void 0),r=t.reduce(((t,n)=>t?e(t,n.decode):n.decode),void 0);return{encode:n,decode:r}}function wn(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&"number"!=typeof e[0])throw new Error("alphabet.encode input should be an array of numbers");return e.map((e=>{if(gn(e),e<0||e>=t.length)throw new Error(`Digit index outside alphabet: ${e} (alphabet: ${t.length})`);return t[e]}))},decode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("alphabet.decode input should be array of strings");return e.map((e=>{if("string"!=typeof e)throw new Error(`alphabet.decode: not string element=${e}`);const n=t.indexOf(e);if(-1===n)throw new Error(`Unknown letter: "${e}". Allowed: ${t}`);return n}))}}}function bn(t=""){if("string"!=typeof t)throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw new Error("join.encode input should be array of strings");for(let t of e)if("string"!=typeof t)throw new Error(`join.encode: non-string input=${t}`);return e.join(t)},decode:e=>{if("string"!=typeof e)throw new Error("join.decode input should be string");return e.split(t)}}}function mn(t,e="="){if(gn(t),"string"!=typeof e)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let t of n)if("string"!=typeof t)throw new Error(`padding.encode: non-string input=${t}`);for(;n.length*t%8;)n.push(e);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let t of n)if("string"!=typeof t)throw new Error(`padding.decode: non-string input=${t}`);let r=n.length;if(r*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===e;r--)if(!((r-1)*t%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function En(t){if("function"!=typeof t)throw new Error("normalize fn should be function");return{encode:t=>t,decode:e=>t(e)}}function vn(t,e,n){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const o=[],i=Array.from(t);for(i.forEach((t=>{if(gn(t),t<0||t>=e)throw new Error(`Wrong integer: ${t}`)}));;){let t=0,s=!0;for(let o=r;o<i.length;o++){const a=i[o],c=e*t+a;if(!Number.isSafeInteger(c)||e*t/e!==t||c-a!=e*t)throw new Error("convertRadix: carry overflow");if(t=c%n,i[o]=Math.floor(c/n),!Number.isSafeInteger(i[o])||i[o]*n+t!==c)throw new Error("convertRadix: carry overflow");s&&(i[o]?s=!1:r=o)}if(o.push(t),s)break}for(let e=0;e<t.length-1&&0===t[e];e++)o.push(0);return o.reverse()}const $n=(t,e)=>e?$n(e,t%e):t,xn=(t,e)=>t+(e-$n(t,e));function An(t,e,n,r){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(xn(e,n)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${n} carryBits=${xn(e,n)}`);let o=0,i=0;const s=2**n-1,a=[];for(const r of t){if(gn(r),r>=2**e)throw new Error(`convertRadix2: invalid data word=${r} from=${e}`);if(o=o<<e|r,i+e>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${e}`);for(i+=e;i>=n;i-=n)a.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=e)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&a.push(o>>>0),a}function kn(t,e=!1){if(gn(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(xn(8,t)>32||xn(t,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return An(Array.from(n),8,t,!e)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(An(n,t,8,e))}}}function Sn(t){if("function"!=typeof t)throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch(t){}}}const Bn=yn(kn(4),wn("0123456789ABCDEF"),bn("")),_n=yn(kn(5),wn("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),mn(5),bn(""));yn(kn(5),wn("0123456789ABCDEFGHIJKLMNOPQRSTUV"),mn(5),bn("")),yn(kn(5),wn("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),bn(""),En((t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))));const In=yn(kn(6),wn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),mn(6),bn("")),On=yn(kn(6),wn("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),mn(6),bn("")),Ln=t=>{return yn((gn(e=58),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return vn(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(vn(t,e,256))}}),wn(t),bn(""));var e},Un=Ln("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Ln("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),Ln("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const Rn=[0,2,3,5,6,7,9,10,11],Tn={encode(t){let e="";for(let n=0;n<t.length;n+=8){const r=t.subarray(n,n+8);e+=Un.encode(r).padStart(Rn[r.length],"1")}return e},decode(t){let e=[];for(let n=0;n<t.length;n+=11){const r=t.slice(n,n+11),o=Rn.indexOf(r.length),i=Un.decode(r);for(let t=0;t<i.length-o;t++)if(0!==i[t])throw new Error("base58xmr: wrong padding");e=e.concat(Array.from(i.slice(i.length-o)))}return Uint8Array.from(e)}},Nn=yn(wn("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),bn("")),Pn=[996825010,642813549,513874426,1027748829,705979059];function Cn(t){const e=t>>25;let n=(33554431&t)<<5;for(let t=0;t<Pn.length;t++)1==(e>>t&1)&&(n^=Pn[t]);return n}function Hn(t,e,n=1){const r=t.length;let o=1;for(let e=0;e<r;e++){const n=t.charCodeAt(e);if(n<33||n>126)throw new Error(`Invalid prefix (${t})`);o=Cn(o)^n>>5}o=Cn(o);for(let e=0;e<r;e++)o=Cn(o)^31&t.charCodeAt(e);for(let t of e)o=Cn(o)^t;for(let t=0;t<6;t++)o=Cn(o);return o^=n,Nn.encode(An([o%2**30],30,5,!1))}function qn(t){const e="bech32"===t?1:734539939,n=kn(5),r=n.decode,o=n.encode,i=Sn(r);function s(t,n=90){if("string"!=typeof t)throw new Error("bech32.decode input should be string, not "+typeof t);if(t.length<8||!1!==n&&t.length>n)throw new TypeError(`Wrong string length: ${t.length} (${t}). Expected (8..${n})`);const r=t.toLowerCase();if(t!==r&&t!==t.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=(t=r).lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=t.slice(0,o),s=t.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=Nn.decode(s).slice(0,-6),c=Hn(i,a,e);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${t}: expected "${c}"`);return{prefix:i,words:a}}return{encode:function(t,n,r=90){if("string"!=typeof t)throw new Error("bech32.encode prefix should be string, not "+typeof t);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);const o=t.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);return`${t=t.toLowerCase()}1${Nn.encode(n)}${Hn(t,n,e)}`},decode:s,decodeToBytes:function(t){const{prefix:e,words:n}=s(t,!1);return{prefix:e,words:n,bytes:r(n)}},decodeUnsafe:Sn(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}const Dn=qn("bech32");qn("bech32m");const Mn={utf8:{encode:t=>(new TextDecoder).decode(t),decode:t=>(new TextEncoder).encode(t)},hex:yn(kn(4),wn("0123456789abcdef"),bn(""),En((t=>{if("string"!=typeof t||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()}))),base16:Bn,base32:_n,base64:In,base64url:On,base58:Un,base58xmr:Tn};function jn(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Fn(t){if("boolean"!=typeof t)throw new Error(`boolean expected, not ${t}`)}function zn(t,...e){if(!((n=t)instanceof Uint8Array||null!=n&&"object"==typeof n&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}
/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */Object.keys(Mn).join(", ");const Vn=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");const Kn=16;function Wn(t){return t<<1^283&-(t>>7)}function Zn(t,e){let n=0;for(;e>0;e>>=1)n^=t&-(1&e),t=Wn(t);return n}const Jn=(()=>{let t=new Uint8Array(256);for(let e=0,n=1;e<256;e++,n^=Wn(n))t[e]=n;const e=new Uint8Array(256);e[0]=99;for(let n=0;n<255;n++){let r=t[255-n];r|=r<<8,e[t[n]]=255&(r^r>>4^r>>5^r>>6^r>>7^99)}return e})(),Gn=Jn.map(((t,e)=>Jn.indexOf(e))),Yn=t=>t<<8|t>>>24;function Qn(t,e){if(256!==t.length)throw new Error("Wrong sbox length");const n=new Uint32Array(256).map(((n,r)=>e(t[r]))),r=n.map(Yn),o=r.map(Yn),i=o.map(Yn),s=new Uint32Array(65536),a=new Uint32Array(65536),c=new Uint16Array(65536);for(let e=0;e<256;e++)for(let u=0;u<256;u++){const l=256*e+u;s[l]=n[e]^r[u],a[l]=o[e]^i[u],c[l]=t[e]<<8|t[u]}return{sbox:t,sbox2:c,T0:n,T1:r,T2:o,T3:i,T01:s,T23:a}}const Xn=Qn(Jn,(t=>Zn(t,3)<<24|t<<16|t<<8|Zn(t,2))),tr=Qn(Gn,(t=>Zn(t,11)<<24|Zn(t,13)<<16|Zn(t,9)<<8|Zn(t,14))),er=(()=>{const t=new Uint8Array(16);for(let e=0,n=1;e<16;e++,n=Wn(n))t[e]=n;return t})();function nr(t){zn(t);const e=t.length;if(![16,24,32].includes(e))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);const{sbox2:n}=Xn,r=Vn(t),o=r.length,i=t=>or(n,t,t,t,t),s=new Uint32Array(e+28);s.set(r);for(let t=o;t<s.length;t++){let e=s[t-1];t%o==0?e=i((a=e)<<24|a>>>8)^er[t/o-1]:o>6&&t%o==4&&(e=i(e)),s[t]=s[t-o]^e}var a;return s}function rr(t,e,n,r,o,i){return t[n<<8&65280|r>>>8&255]^e[o>>>8&65280|i>>>24&255]}function or(t,e,n,r,o){return t[255&e|65280&n]|t[r>>>16&255|o>>>16&65280]<<16}function ir(t,e,n,r,o){const{sbox2:i,T01:s,T23:a}=Xn;let c=0;e^=t[c++],n^=t[c++],r^=t[c++],o^=t[c++];const u=t.length/4-2;for(let i=0;i<u;i++){const i=t[c++]^rr(s,a,e,n,r,o),u=t[c++]^rr(s,a,n,r,o,e),l=t[c++]^rr(s,a,r,o,e,n),f=t[c++]^rr(s,a,o,e,n,r);e=i,n=u,r=l,o=f}return{s0:t[c++]^or(i,e,n,r,o),s1:t[c++]^or(i,n,r,o,e),s2:t[c++]^or(i,r,o,e,n),s3:t[c++]^or(i,o,e,n,r)}}function sr(t,e,n,r,o){const{sbox2:i,T01:s,T23:a}=tr;let c=0;e^=t[c++],n^=t[c++],r^=t[c++],o^=t[c++];const u=t.length/4-2;for(let i=0;i<u;i++){const i=t[c++]^rr(s,a,e,o,r,n),u=t[c++]^rr(s,a,n,e,o,r),l=t[c++]^rr(s,a,r,n,e,o),f=t[c++]^rr(s,a,o,r,n,e);e=i,n=u,r=l,o=f}return{s0:t[c++]^or(i,e,o,r,n),s1:t[c++]^or(i,n,e,o,r),s2:t[c++]^or(i,r,n,e,o),s3:t[c++]^or(i,o,r,n,e)}}function ar(t,e){if(!e)return new Uint8Array(t);if(zn(e),e.length<t)throw new Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);return e}const cr=(ur={blockSize:16,nonceLength:16},lr=function(t,e,n={}){zn(t),zn(e,16);const r=!n.disablePadding;return{encrypt:(n,o)=>{const i=nr(t),{b:s,o:a,out:c}=function(t,e,n){let r=t.length;const o=r%Kn;if(!e&&0!==o)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const i=Vn(t);if(e){let t=Kn-o;t||(t=Kn),r+=t}const s=ar(r,n);return{b:i,o:Vn(s),out:s}}(n,r,o),u=Vn(e);let l=u[0],f=u[1],h=u[2],d=u[3],p=0;for(;p+4<=s.length;)l^=s[p+0],f^=s[p+1],h^=s[p+2],d^=s[p+3],({s0:l,s1:f,s2:h,s3:d}=ir(i,l,f,h,d)),a[p++]=l,a[p++]=f,a[p++]=h,a[p++]=d;if(r){const t=function(t){const e=new Uint8Array(16),n=Vn(e);e.set(t);const r=Kn-t.length;for(let t=Kn-r;t<Kn;t++)e[t]=r;return n}(n.subarray(4*p));l^=t[0],f^=t[1],h^=t[2],d^=t[3],({s0:l,s1:f,s2:h,s3:d}=ir(i,l,f,h,d)),a[p++]=l,a[p++]=f,a[p++]=h,a[p++]=d}return i.fill(0),c},decrypt:(n,o)=>{!function(t){if(zn(t),t.length%Kn!=0)throw new Error("aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size 16")}(n);const i=function(t){const e=nr(t),n=e.slice(),r=e.length,{sbox2:o}=Xn,{T0:i,T1:s,T2:a,T3:c}=tr;for(let t=0;t<r;t+=4)for(let o=0;o<4;o++)n[t+o]=e[r-t-4+o];e.fill(0);for(let t=4;t<r-4;t++){const e=n[t],r=or(o,e,e,e,e);n[t]=i[255&r]^s[r>>>8&255]^a[r>>>16&255]^c[r>>>24]}return n}(t),s=Vn(e),a=ar(n.length,o),c=Vn(n),u=Vn(a);let l=s[0],f=s[1],h=s[2],d=s[3];for(let t=0;t+4<=c.length;){const e=l,n=f,r=h,o=d;l=c[t+0],f=c[t+1],h=c[t+2],d=c[t+3];const{s0:s,s1:a,s2:p,s3:g}=sr(i,l,f,h,d);u[t++]=s^e,u[t++]=a^n,u[t++]=p^r,u[t++]=g^o}return i.fill(0),function(t,e){if(!e)return t;const n=t.length;if(!n)throw new Error("aes/pcks5: empty ciphertext not allowed");const r=t[n-1];if(r<=0||r>16)throw new Error(`aes/pcks5: wrong padding byte: ${r}`);const o=t.subarray(0,-r);for(let e=0;e<r;e++)if(t[n-e-1]!==r)throw new Error("aes/pcks5: wrong padding");return o}(a,r)}}},Object.assign(lr,ur),lr);var ur,lr;const fr=t=>Uint8Array.from(t.split("").map((t=>t.charCodeAt(0)))),hr=fr("expand 16-byte k"),dr=fr("expand 32-byte k"),pr=Vn(hr),gr=Vn(dr);function yr(t,e){return t<<e|t>>>32-e}function wr(t){return t.byteOffset%4==0}gr.slice();const br=2**32-1,mr=new Uint32Array;function Er(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:o,counterRight:i,rounds:s}=function(t,e){if(null==e||"object"!=typeof e)throw new Error("options must be defined");return Object.assign(t,e)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if("function"!=typeof t)throw new Error("core must be a function");return jn(o),jn(s),Fn(i),Fn(n),(e,a,c,u,l=0)=>{zn(e),zn(a),zn(c);const f=c.length;if(u||(u=new Uint8Array(f)),zn(u),jn(l),l<0||l>=br)throw new Error("arx: counter overflow");if(u.length<f)throw new Error(`arx: output (${u.length}) is shorter than data (${f})`);const h=[];let d,p,g=e.length;if(32===g)d=e.slice(),h.push(d),p=gr;else{if(16!==g||!n)throw new Error(`arx: invalid 32-byte key, got length=${g}`);d=new Uint8Array(32),d.set(e),d.set(e,16),p=pr,h.push(d)}wr(a)||(a=a.slice(),h.push(a));const y=Vn(d);if(r){if(24!==a.length)throw new Error("arx: extended nonce must be 24 bytes");r(p,y,Vn(a.subarray(0,16)),y),a=a.subarray(16)}const w=16-o;if(w!==a.length)throw new Error(`arx: nonce must be ${w} or 16 bytes`);if(12!==w){const t=new Uint8Array(12);t.set(a,i?0:12-a.length),a=t,h.push(a)}const b=Vn(a);for(!function(t,e,n,r,o,i,s,a){const c=o.length,u=new Uint8Array(64),l=Vn(u),f=wr(o)&&wr(i),h=f?Vn(o):mr,d=f?Vn(i):mr;for(let p=0;p<c;s++){if(t(e,n,r,l,s,a),s>=br)throw new Error("arx: counter overflow");const g=Math.min(64,c-p);if(f&&64===g){const t=p/4;if(p%4!=0)throw new Error("arx: invalid block position");for(let e,n=0;n<16;n++)e=t+n,d[e]=h[e]^l[n];p+=64}else{for(let t,e=0;e<g;e++)t=p+e,i[t]=o[t]^u[e];p+=g}}}(t,p,y,b,c,u,l,s);h.length>0;)h.pop().fill(0);return u}}function vr(t,e,n,r,o,i=20){let s=t[0],a=t[1],c=t[2],u=t[3],l=e[0],f=e[1],h=e[2],d=e[3],p=e[4],g=e[5],y=e[6],w=e[7],b=o,m=n[0],E=n[1],v=n[2],$=s,x=a,A=c,k=u,S=l,B=f,_=h,I=d,O=p,L=g,U=y,R=w,T=b,N=m,P=E,C=v;for(let t=0;t<i;t+=2)$=$+S|0,T=yr(T^$,16),O=O+T|0,S=yr(S^O,12),$=$+S|0,T=yr(T^$,8),O=O+T|0,S=yr(S^O,7),x=x+B|0,N=yr(N^x,16),L=L+N|0,B=yr(B^L,12),x=x+B|0,N=yr(N^x,8),L=L+N|0,B=yr(B^L,7),A=A+_|0,P=yr(P^A,16),U=U+P|0,_=yr(_^U,12),A=A+_|0,P=yr(P^A,8),U=U+P|0,_=yr(_^U,7),k=k+I|0,C=yr(C^k,16),R=R+C|0,I=yr(I^R,12),k=k+I|0,C=yr(C^k,8),R=R+C|0,I=yr(I^R,7),$=$+B|0,C=yr(C^$,16),U=U+C|0,B=yr(B^U,12),$=$+B|0,C=yr(C^$,8),U=U+C|0,B=yr(B^U,7),x=x+_|0,T=yr(T^x,16),R=R+T|0,_=yr(_^R,12),x=x+_|0,T=yr(T^x,8),R=R+T|0,_=yr(_^R,7),A=A+I|0,N=yr(N^A,16),O=O+N|0,I=yr(I^O,12),A=A+I|0,N=yr(N^A,8),O=O+N|0,I=yr(I^O,7),k=k+S|0,P=yr(P^k,16),L=L+P|0,S=yr(S^L,12),k=k+S|0,P=yr(P^k,8),L=L+P|0,S=yr(S^L,7);let H=0;r[H++]=s+$|0,r[H++]=a+x|0,r[H++]=c+A|0,r[H++]=u+k|0,r[H++]=l+S|0,r[H++]=f+B|0,r[H++]=h+_|0,r[H++]=d+I|0,r[H++]=p+O|0,r[H++]=g+L|0,r[H++]=y+U|0,r[H++]=w+R|0,r[H++]=b+T|0,r[H++]=m+N|0,r[H++]=E+P|0,r[H++]=v+C|0}const $r=Er(vr,{counterRight:!1,counterLength:4,allowShortKeys:!1});class xr extends Ce{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,je.hash(t);const n=Ne(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let t=0;t<o.length;t++)o[t]^=54;this.iHash.update(o),this.oHash=t.create();for(let t=0;t<o.length;t++)o[t]^=106;this.oHash.update(o),o.fill(0)}update(t){return je.exists(this),this.iHash.update(t),this}digestInto(t){je.exists(this),je.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return t.finished=r,t.destroyed=o,t.blockLen=i,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Ar=(t,e,n)=>new xr(t,e).update(n).digest();Ar.create=(t,e)=>new xr(t,e);const kr=new Uint8Array([0]),Sr=new Uint8Array;var Br=Object.defineProperty,_r=(t,e)=>{for(var n in e)Br(t,n,{get:e[n],enumerable:!0})},Ir=Symbol("verified");function Or(t){if(!(t instanceof Object))return!1;if("number"!=typeof t.kind)return!1;if("string"!=typeof t.content)return!1;if("number"!=typeof t.created_at)return!1;if("string"!=typeof t.pubkey)return!1;if(!t.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let n=t.tags[e];if(!Array.isArray(n))return!1;for(let t=0;t<n.length;t++)if("object"==typeof n[t])return!1}return!0}_r({},{Queue:()=>Hr,QueueNode:()=>Cr,binarySearch:()=>Pr,insertEventIntoAscendingList:()=>Nr,insertEventIntoDescendingList:()=>Tr,normalizeURL:()=>Rr,utf8Decoder:()=>Lr,utf8Encoder:()=>Ur});var Lr=new TextDecoder("utf-8"),Ur=new TextEncoder;function Rr(t){-1===t.indexOf("://")&&(t="wss://"+t);let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),("80"===e.port&&"ws:"===e.protocol||"443"===e.port&&"wss:"===e.protocol)&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}function Tr(t,e){const[n,r]=Pr(t,(t=>e.id===t.id?0:e.created_at===t.created_at?-1:t.created_at-e.created_at));return r||t.splice(n,0,e),t}function Nr(t,e){const[n,r]=Pr(t,(t=>e.id===t.id?0:e.created_at===t.created_at?-1:e.created_at-t.created_at));return r||t.splice(n,0,e),t}function Pr(t,e){let n=0,r=t.length-1;for(;n<=r;){const o=Math.floor((n+r)/2),i=e(t[o]);if(0===i)return[o,!0];i<0?r=o-1:n=o+1}return[n,!1]}var Cr=class{value;next=null;prev=null;constructor(t){this.value=t}},Hr=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const e=new Cr(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const t=this.first;return this.first=null,this.last=null,t.value}const t=this.first;return this.first=t.next,t.value}};function qr(t){return Re(Ge(Ur.encode(function(t){if(!Or(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}(t))))}var Dr=new class{generateSecretKey(){return Be.utils.randomPrivateKey()}getPublicKey(t){return Re(Be.getPublicKey(t))}finalizeEvent(t,e){const n=t;return n.pubkey=Re(Be.getPublicKey(e)),n.id=qr(n),n.sig=Re(Be.sign(qr(n),e)),n[Ir]=!0,n}verifyEvent(t){if("boolean"==typeof t[Ir])return t[Ir];const e=qr(t);if(e!==t.id)return t[Ir]=!1,!1;try{const n=Be.verify(t.sig,e,t.pubkey);return t[Ir]=n,n}catch(e){return t[Ir]=!1,!1}}},Mr=Dr.generateSecretKey,jr=Dr.getPublicKey,Fr=Dr.finalizeEvent,zr=Dr.verifyEvent;function Vr(t){return 1e3<=t&&t<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(t)}function Kr(t){return[0,3].includes(t)||1e4<=t&&t<2e4}function Wr(t){return 2e4<=t&&t<3e4}function Zr(t){return 3e4<=t&&t<4e4}function Jr(t){return Vr(t)?"regular":Kr(t)?"replaceable":Wr(t)?"ephemeral":Zr(t)?"parameterized":"unknown"}function Gr(t,e){const n=e instanceof Array?e:[e];return Or(t)&&n.includes(t.kind)||!1}_r({},{Application:()=>ui,BadgeAward:()=>io,BadgeDefinition:()=>ni,BlockedRelaysList:()=>Co,BookmarkList:()=>To,Bookmarksets:()=>Xo,Calendar:()=>yi,CalendarEventRSVP:()=>wi,ChannelCreation:()=>uo,ChannelHideMessage:()=>ho,ChannelMessage:()=>fo,ChannelMetadata:()=>lo,ChannelMuteUser:()=>po,ClassifiedListing:()=>hi,ClientAuth:()=>Vo,CommunitiesList:()=>No,CommunityDefinition:()=>Ei,CommunityPostApproval:()=>xo,Contacts:()=>to,CreateOrUpdateProduct:()=>ii,CreateOrUpdateStall:()=>oi,Curationsets:()=>ti,Date:()=>pi,DirectMessageRelaysList:()=>Mo,DraftClassifiedListing:()=>di,DraftLong:()=>ai,Emojisets:()=>ci,EncryptedDirectMessage:()=>eo,EventDeletion:()=>no,FileMetadata:()=>wo,FileServerPreference:()=>jo,Followsets:()=>Go,GenericRepost:()=>co,Genericlists:()=>Yo,GiftWrap:()=>yo,HTTPAuth:()=>Jo,Handlerinformation:()=>mi,Handlerrecommendation:()=>bi,Highlights:()=>Oo,InterestsList:()=>qo,Interestsets:()=>ri,JobFeedback:()=>So,JobRequest:()=>Ao,JobResult:()=>ko,Label:()=>$o,LightningPubRPC:()=>zo,LiveChatMessage:()=>bo,LiveEvent:()=>li,LongFormArticle:()=>si,Metadata:()=>Yr,Mutelist:()=>Lo,NWCWalletInfo:()=>Fo,NWCWalletRequest:()=>Ko,NWCWalletResponse:()=>Wo,NostrConnect:()=>Zo,OpenTimestamps:()=>go,Pinlist:()=>Uo,PrivateDirectMessage:()=>ao,ProblemTracker:()=>mo,ProfileBadges:()=>ei,PublicChatsList:()=>Po,Reaction:()=>oo,RecommendRelay:()=>Xr,RelayList:()=>Ro,Relaysets:()=>Qo,Report:()=>Eo,Reporting:()=>vo,Repost:()=>ro,Seal:()=>so,SearchRelaysList:()=>Ho,ShortTextNote:()=>Qr,Time:()=>gi,UserEmojiList:()=>Do,UserStatuses:()=>fi,Zap:()=>Io,ZapGoal:()=>Bo,ZapRequest:()=>_o,classifyKind:()=>Jr,isEphemeralKind:()=>Wr,isKind:()=>Gr,isParameterizedReplaceableKind:()=>Zr,isRegularKind:()=>Vr,isReplaceableKind:()=>Kr});var Yr=0,Qr=1,Xr=2,to=3,eo=4,no=5,ro=6,oo=7,io=8,so=13,ao=14,co=16,uo=40,lo=41,fo=42,ho=43,po=44,go=1040,yo=1059,wo=1063,bo=1311,mo=1971,Eo=1984,vo=1984,$o=1985,xo=4550,Ao=5999,ko=6999,So=7e3,Bo=9041,_o=9734,Io=9735,Oo=9802,Lo=1e4,Uo=10001,Ro=10002,To=10003,No=10004,Po=10005,Co=10006,Ho=10007,qo=10015,Do=10030,Mo=10050,jo=10096,Fo=13194,zo=21e3,Vo=22242,Ko=23194,Wo=23195,Zo=24133,Jo=27235,Go=3e4,Yo=30001,Qo=30002,Xo=30003,ti=30004,ei=30008,ni=30009,ri=30015,oi=30017,ii=30018,si=30023,ai=30024,ci=30030,ui=30078,li=30311,fi=30315,hi=30402,di=30403,pi=31922,gi=31923,yi=31924,wi=31925,bi=31989,mi=31990,Ei=34550;function vi(t,e){let n=e.length+3,r=t.indexOf(`"${e}":`)+n,o=t.slice(r).indexOf('"')+r+1;return t.slice(o,o+64)}function $i(t,e){let n=e.length,r=t.indexOf(`"${e}":`)+n+3,o=t.slice(r),i=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,i),10)}function xi(t){let e=t.slice(0,22).indexOf('"EVENT"');if(-1===e)return null;let n=t.slice(e+7+1).indexOf('"');if(-1===n)return null;let r=e+7+1+n,o=t.slice(r+1,80).indexOf('"');if(-1===o)return null;let i=r+1+o;return t.slice(r+1,i)}function Ai(t,e){return e===vi(t,"id")}function ki(t,e){return e===vi(t,"pubkey")}function Si(t,e){return e===$i(t,"kind")}_r({},{getHex64:()=>vi,getInt:()=>$i,getSubscriptionId:()=>xi,matchEventId:()=>Ai,matchEventKind:()=>Si,matchEventPubkey:()=>ki});function Bi(t,e){return{kind:Vo,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}_r({},{makeAuthEvent:()=>Bi});try{WebSocket}catch{}try{WebSocket}catch{}var _i={};_r(_i,{BECH32_REGEX:()=>Li,Bech32MaxSize:()=>Oi,NostrTypeGuard:()=>Ii,decode:()=>Ui,encodeBytes:()=>Hi,naddrEncode:()=>Mi,neventEncode:()=>Di,noteEncode:()=>Pi,nprofileEncode:()=>qi,npubEncode:()=>Ni,nsecEncode:()=>Ti});var Ii={isNProfile:t=>/^nprofile1[a-z\d]+$/.test(t||""),isNEvent:t=>/^nevent1[a-z\d]+$/.test(t||""),isNAddr:t=>/^naddr1[a-z\d]+$/.test(t||""),isNSec:t=>/^nsec1[a-z\d]{58}$/.test(t||""),isNPub:t=>/^npub1[a-z\d]{58}$/.test(t||""),isNote:t=>/^note1[a-z\d]+$/.test(t||""),isNcryptsec:t=>/^ncryptsec1[a-z\d]+$/.test(t||"")},Oi=5e3,Li=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function Ui(t){let{prefix:e,words:n}=Dn.decode(t,Oi),r=new Uint8Array(Dn.fromWords(n));switch(e){case"nprofile":{let t=Ri(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==t[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:Re(t[0][0]),relays:t[1]?t[1].map((t=>Lr.decode(t))):[]}}}case"nevent":{let t=Ri(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==t[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(t[2]&&32!==t[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(t[3]&&4!==t[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:Re(t[0][0]),relays:t[1]?t[1].map((t=>Lr.decode(t))):[],author:t[2]?.[0]?Re(t[2][0]):void 0,kind:t[3]?.[0]?parseInt(Re(t[3][0]),16):void 0}}}case"naddr":{let t=Ri(r);if(!t[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!t[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==t[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!t[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==t[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:Lr.decode(t[0][0]),pubkey:Re(t[2][0]),kind:parseInt(Re(t[3][0]),16),relays:t[1]?t[1].map((t=>Lr.decode(t))):[]}}}case"nsec":return{type:e,data:r};case"npub":case"note":return{type:e,data:Re(r)};default:throw new Error(`unknown prefix ${e}`)}}function Ri(t){let e={},n=t;for(;n.length>0;){let t=n[0],r=n[1],o=n.slice(2,2+r);if(n=n.slice(2+r),o.length<r)throw new Error(`not enough data to read on TLV ${t}`);e[t]=e[t]||[],e[t].push(o)}return e}function Ti(t){return Hi("nsec",t)}function Ni(t){return Hi("npub",Te(t))}function Pi(t){return Hi("note",Te(t))}function Ci(t,e){let n=Dn.toWords(e);return Dn.encode(t,n,Oi)}function Hi(t,e){return Ci(t,e)}function qi(t){return Ci("nprofile",ji({0:[Te(t.pubkey)],1:(t.relays||[]).map((t=>Ur.encode(t)))}))}function Di(t){let e;return void 0!==t.kind&&(e=function(t){const e=new Uint8Array(4);return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=255&t,e}(t.kind)),Ci("nevent",ji({0:[Te(t.id)],1:(t.relays||[]).map((t=>Ur.encode(t))),2:t.author?[Te(t.author)]:[],3:e?[new Uint8Array(e)]:[]}))}function Mi(t){let e=new ArrayBuffer(4);return new DataView(e).setUint32(0,t.kind,!1),Ci("naddr",ji({0:[Ur.encode(t.identifier)],1:(t.relays||[]).map((t=>Ur.encode(t))),2:[Te(t.pubkey)],3:[new Uint8Array(e)]}))}function ji(t){let e=[];return Object.entries(t).reverse().forEach((([t,n])=>{n.forEach((n=>{let r=new Uint8Array(n.length+2);r.set([parseInt(t)],0),r.set([n.length],1),r.set(n,2),e.push(r)}))})),Pe(...e)}async function Fi(t,e,n){const r=t instanceof Uint8Array?Re(t):t,o=Vi(fe.getSharedSecret(r,"02"+e));let i=Uint8Array.from(qe(16)),s=Ur.encode(n),a=cr(o,i).encrypt(s);return`${In.encode(new Uint8Array(a))}?iv=${In.encode(new Uint8Array(i.buffer))}`}async function zi(t,e,n){const r=t instanceof Uint8Array?Re(t):t;let[o,i]=n.split("?iv="),s=Vi(fe.getSharedSecret(r,"02"+e)),a=In.decode(i),c=In.decode(o),u=cr(s,a).decrypt(c);return Lr.decode(u)}function Vi(t){return t.slice(1,33)}_r({},{decrypt:()=>zi,encrypt:()=>Fi});_r({},{NIP05_REGEX:()=>Wi,isNip05:()=>Zi,isValid:()=>Qi,queryProfile:()=>Yi,searchDomain:()=>Gi,useFetchImplementation:()=>Ji});var Ki,Wi=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,Zi=t=>Wi.test(t||"");try{Ki=fetch}catch(t){}function Ji(t){Ki=t}async function Gi(t,e=""){try{const n=`https://${t}/.well-known/nostr.json?name=${e}`,r=await Ki(n,{redirect:"manual"});if(200!==r.status)throw Error("Wrong response code");return(await r.json()).names}catch(t){return{}}}async function Yi(t){const e=t.match(Wi);if(!e)return null;const[,n="_",r]=e;try{const t=`https://${r}/.well-known/nostr.json?name=${n}`,e=await Ki(t,{redirect:"manual"});if(200!==e.status)throw Error("Wrong response code");const o=await e.json(),i=o.names[n];return i?{pubkey:i,relays:o.relays?.[i]}:null}catch(t){return null}}async function Qi(t,e){const n=await Yi(e);return!!n&&n.pubkey===t}function Xi(t){const e={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let n,r;for(let o=t.tags.length-1;o>=0;o--){const i=t.tags[o];if("e"===i[0]&&i[1]){const[t,o,s,a,c]=i,u={id:o,relays:s?[s]:[],author:c};if("root"===a){e.root=u;continue}if("reply"===a){e.reply=u;continue}if("mention"===a){e.mentions.push(u);continue}n?r=u:n=u,e.mentions.push(u)}else{if("q"===i[0]&&i[1]){const[t,n,r]=i;e.quotes.push({id:n,relays:r?[r]:[]})}"p"===i[0]&&i[1]&&e.profiles.push({pubkey:i[1],relays:i[2]?[i[2]]:[]})}}return e.root||(e.root=r||n||e.reply),e.reply||(e.reply=n||e.root),[e.reply,e.root].forEach((t=>{if(!t)return;let n=e.mentions.indexOf(t);if(-1!==n&&e.mentions.splice(n,1),t.author){let n=e.profiles.find((e=>e.pubkey===t.author));n&&n.relays&&(t.relays||(t.relays=[]),n.relays.forEach((e=>{-1===t.relays?.indexOf(e)&&t.relays.push(e)})),n.relays=t.relays)}})),e.mentions.forEach((t=>{if(t.author){let n=e.profiles.find((e=>e.pubkey===t.author));n&&n.relays&&(t.relays||(t.relays=[]),n.relays.forEach((e=>{-1===t.relays.indexOf(e)&&t.relays.push(e)})),n.relays=t.relays)}})),e}_r({},{parse:()=>Xi});_r({},{fetchRelayInformation:()=>es,useFetchImplementation:()=>ts});try{fetch}catch{}function ts(t){0}async function es(t){return await(await fetch(t.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}function ns(t){let e=0;for(let n=0;n<64;n+=8){const r=parseInt(t.substring(n,n+8),16);if(0!==r){e+=Math.clz32(r);break}e+=32}return e}function rs(t,e){let n=0;const r=t,o=["nonce",n.toString(),e.toString()];for(r.tags.push(o);;){const t=Math.floor((new Date).getTime()/1e3);if(t!==r.created_at&&(n=0,r.created_at=t),o[1]=(++n).toString(),r.id=os(r),ns(r.id)>=e)break}return r}function os(t){return Re(Ge(Ur.encode(JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]))))}_r({},{fastEventHash:()=>os,getPow:()=>ns,minePow:()=>rs});function is(t,e,n,r){return Fr({kind:ro,tags:[...t.tags??[],["e",e.id,n],["p",e.pubkey]],content:""===t.content?"":JSON.stringify(e),created_at:t.created_at},r)}function ss(t){if(t.kind!==ro)return;let e,n;for(let r=t.tags.length-1;r>=0&&(void 0===e||void 0===n);r--){const o=t.tags[r];o.length>=2&&("e"===o[0]&&void 0===e?e=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==e?{id:e[1],relays:[e[2],n?.[2]].filter((t=>"string"==typeof t)),author:n?.[1]}:void 0}function as(t,{skipVerification:e}={}){const n=ss(t);if(void 0===n||""===t.content)return;let r;try{r=JSON.parse(t.content)}catch(t){return}return r.id===n.id&&(e||zr(r))?r:void 0}_r({},{finishRepostEvent:()=>is,getRepostedEvent:()=>as,getRepostedEventPointer:()=>ss});_r({},{NOSTR_URI_REGEX:()=>cs,parse:()=>ls,test:()=>us});var cs=new RegExp(`nostr:(${Li.source})`);function us(t){return"string"==typeof t&&new RegExp(`^${cs.source}$`).test(t)}function ls(t){const e=t.match(new RegExp(`^${cs.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:e[0],value:e[1],decoded:Ui(e[1])}}function fs(t,e,n){const r=e.tags.filter((t=>t.length>=2&&("e"===t[0]||"p"===t[0])));return Fr({...t,kind:oo,tags:[...t.tags??[],...r,["e",e.id],["p",e.pubkey]],content:t.content??"+"},n)}function hs(t){if(t.kind!==oo)return;let e,n;for(let r=t.tags.length-1;r>=0&&(void 0===e||void 0===n);r--){const o=t.tags[r];o.length>=2&&("e"===o[0]&&void 0===e?e=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==e&&void 0!==n?{id:e[1],relays:[e[2],n[2]].filter((t=>void 0!==t)),author:n[1]}:void 0}_r({},{finishReactionEvent:()=>fs,getReactedEventPointer:()=>hs});_r({},{matchAll:()=>ps,regex:()=>ds,replaceAll:()=>gs});var ds=()=>new RegExp(`\\b${cs.source}\\b`,"g");function*ps(t){const e=t.matchAll(ds());for(const t of e)try{const[e,n]=t;yield{uri:e,value:n,decoded:Ui(n),start:t.index,end:t.index+e.length}}catch(t){}}function gs(t,e){return t.replaceAll(ds(),((t,n)=>e({uri:t,value:n,decoded:Ui(n)})))}_r({},{channelCreateEvent:()=>ys,channelHideMessageEvent:()=>ms,channelMessageEvent:()=>bs,channelMetadataEvent:()=>ws,channelMuteUserEvent:()=>Es});var ys=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return Fr({kind:uo,tags:[...t.tags??[]],content:n,created_at:t.created_at},e)},ws=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return Fr({kind:lo,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},bs=(t,e)=>{const n=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&n.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),Fr({kind:fo,tags:[...n,...t.tags??[]],content:t.content,created_at:t.created_at},e)},ms=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return Fr({kind:ho,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:n,created_at:t.created_at},e)},Es=(t,e)=>{let n;if("object"==typeof t.content)n=JSON.stringify(t.content);else{if("string"!=typeof t.content)return;n=t.content}return Fr({kind:po,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:n,created_at:t.created_at},e)};_r({},{EMOJI_SHORTCODE_REGEX:()=>vs,matchAll:()=>xs,regex:()=>$s,replaceAll:()=>As});var vs=/:(\w+):/,$s=()=>new RegExp(`\\B${vs.source}\\B`,"g");function*xs(t){const e=t.matchAll($s());for(const t of e)try{const[e,n]=t;yield{shortcode:e,name:n,start:t.index,end:t.index+e.length}}catch(t){}}function As(t,e){return t.replaceAll($s(),((t,n)=>e({shortcode:t,name:n})))}var ks;_r({},{useFetchImplementation:()=>Ss,validateGithub:()=>Bs});try{ks=fetch}catch{}function Ss(t){ks=t}async function Bs(t,e,n){try{return await(await ks(`https://gist.github.com/${e}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${t}`}catch(t){return!1}}_r({},{decrypt:()=>Ps,encrypt:()=>Ns,getConversationKey:()=>Os,v2:()=>Cs});var _s=1,Is=65535;function Os(t,e){const n=fe.getSharedSecret(t,"02"+e).subarray(1,33);return function(t,e,n){return je.hash(t),Ar(t,Ne(n),Ne(e))}(Ge,n,"nip44-v2")}function Ls(t,e){const n=function(t,e,n,r=32){if(je.hash(t),je.number(r),r>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/t.outputLen);void 0===n&&(n=Sr);const i=new Uint8Array(o*t.outputLen),s=Ar.create(t,e),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let e=0;e<o;e++)kr[0]=e+1,a.update(0===e?Sr:c).update(n).update(kr).digestInto(c),i.set(c,t.outputLen*e),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),kr.fill(0),i.slice(0,r)}(Ge,t,e,76);return{chacha_key:n.subarray(0,32),chacha_nonce:n.subarray(32,44),hmac_key:n.subarray(44,76)}}function Us(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const e=1<<Math.floor(Math.log2(t-1))+1,n=e<=256?32:e/8;return n*(Math.floor((t-1)/n)+1)}function Rs(t){const e=Ur.encode(t),n=e.length;return Pe(function(t){if(!Number.isSafeInteger(t)||t<_s||t>Is)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,t,!1),e}(n),e,new Uint8Array(Us(n)-n))}function Ts(t,e,n){if(32!==n.length)throw new Error("AAD associated data must be 32 bytes");const r=Pe(n,e);return Ar(Ge,t,r)}function Ns(t,e,n=qe(32)){const{chacha_key:r,chacha_nonce:o,hmac_key:i}=Ls(e,n),s=Rs(t),a=$r(r,o,s),c=Ts(i,a,n);return In.encode(Pe(new Uint8Array([2]),n,a,c))}function Ps(t,e){const{nonce:n,ciphertext:r,mac:o}=function(t){if("string"!=typeof t)throw new Error("payload must be a valid string");const e=t.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if("#"===t[0])throw new Error("unknown encryption version");let n;try{n=In.decode(t)}catch(t){throw new Error("invalid base64: "+t.message)}const r=n.length;if(r<99||r>65603)throw new Error("invalid data length: "+r);const o=n[0];if(2!==o)throw new Error("unknown encryption version "+o);return{nonce:n.subarray(1,33),ciphertext:n.subarray(33,-32),mac:n.subarray(-32)}}(t),{chacha_key:i,chacha_nonce:s,hmac_key:a}=Ls(e,n);if(!function(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return 0===n}(Ts(a,r,n),o))throw new Error("invalid MAC");return function(t){const e=new DataView(t.buffer).getUint16(0),n=t.subarray(2,2+e);if(e<_s||e>Is||n.length!==e||t.length!==2+Us(e))throw new Error("invalid padding");return Lr.decode(n)}($r(i,s,r))}var Cs={utils:{getConversationKey:Os,calcPaddedLen:Us},encrypt:Ns,decrypt:Ps};function Hs(t){const{pathname:e,searchParams:n}=new URL(t),r=e,o=n.get("relay"),i=n.get("secret");if(!r||!o||!i)throw new Error("invalid connection string");return{pubkey:r,relay:o,secret:i}}async function qs(t,e,n){const r={method:"pay_invoice",params:{invoice:n}},o=await Fi(e,t,JSON.stringify(r)),i={kind:Ko,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t]]};return Fr(i,e)}_r({},{makeNwcRequestEvent:()=>qs,parseConnectionString:()=>Hs});var Ds;_r({},{getZapEndpoint:()=>js,makeZapReceipt:()=>Vs,makeZapRequest:()=>Fs,useFetchImplementation:()=>Ms,validateZapRequest:()=>zs});try{Ds=fetch}catch{}function Ms(t){Ds=t}async function js(t){try{let e="",{lud06:n,lud16:r}=JSON.parse(t.content);if(n){let{words:t}=Dn.decode(n,1e3),r=Dn.fromWords(t);e=Lr.decode(r)}else{if(!r)return null;{let[t,n]=r.split("@");e=new URL(`/.well-known/lnurlp/${t}`,`https://${n}`).toString()}}let o=await Ds(e),i=await o.json();if(i.allowsNostr&&i.nostrPubkey)return i.callback}catch(t){}return null}function Fs({profile:t,event:e,amount:n,relays:r,comment:o=""}){if(!n)throw new Error("amount not given");if(!t)throw new Error("profile not given");let i={kind:9734,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t],["amount",n.toString()],["relays",...r]]};return e&&i.tags.push(["e",e]),i}function zs(t){let e;try{e=JSON.parse(t)}catch(t){return"Invalid zap request JSON."}if(!Or(e))return"Zap request is not a valid Nostr event.";if(!zr(e))return"Invalid signature on zap request.";let n=e.tags.find((([t,e])=>"p"===t&&e));if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=e.tags.find((([t,e])=>"e"===t&&e));return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find((([t,e])=>"relays"===t&&e))?null:"Zap request doesn't have a 'relays' tag."}function Vs({zapRequest:t,preimage:e,bolt11:n,paidAt:r}){let o=JSON.parse(t),i=o.tags.filter((([t])=>"e"===t||"p"===t||"a"===t)),s={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...i,["P",o.pubkey],["bolt11",n],["description",t]]};return e&&s.tags.push(["preimage",e]),s}_r({},{createRumor:()=>Ys,createSeal:()=>Qs,createWrap:()=>Xs,unwrapEvent:()=>na,unwrapManyEvents:()=>ra,wrapEvent:()=>ta,wrapManyEvents:()=>ea});var Ks=()=>Math.round(Date.now()/1e3),Ws=()=>Math.round(Ks()-172800*Math.random()),Zs=(t,e)=>Os(t,e),Js=(t,e,n)=>Ns(JSON.stringify(t),Zs(e,n)),Gs=(t,e)=>JSON.parse(Ps(t.content,Zs(e,t.pubkey)));function Ys(t,e){const n={created_at:Ks(),content:"",tags:[],...t,pubkey:jr(e)};return n.id=qr(n),n}function Qs(t,e,n){return Fr({kind:so,content:Js(t,e,n),created_at:Ws(),tags:[]},e)}function Xs(t,e){const n=Mr();return Fr({kind:yo,content:Js(t,n,e),created_at:Ws(),tags:[["p",e]]},n)}function ta(t,e,n){return Xs(Qs(Ys(t,e),e,n),n)}function ea(t,e,n){if(!n||0===n.length)throw new Error("At least one recipient is required.");const r=jr(e),o=[ta(t,e,r)];return n.forEach((n=>{o.push(ta(t,e,n))})),o}function na(t,e){const n=Gs(t,e);return Gs(n,e)}function ra(t,e){let n=[];return t.forEach((t=>{n.push(na(t,e))})),n.sort(((t,e)=>t.created_at-e.created_at)),n}_r({},{getToken:()=>ia,hashPayload:()=>ha,unpackEventFromToken:()=>aa,validateEvent:()=>pa,validateEventKind:()=>ua,validateEventMethodTag:()=>fa,validateEventPayloadTag:()=>da,validateEventTimestamp:()=>ca,validateEventUrlTag:()=>la,validateToken:()=>sa});var oa="Nostr ";async function ia(t,e,n,r=!1,o){const i={kind:Jo,tags:[["u",t],["method",e]],created_at:Math.round((new Date).getTime()/1e3),content:""};o&&i.tags.push(["payload",ha(o)]);const s=await n(i);return(r?oa:"")+In.encode(Ur.encode(JSON.stringify(s)))}async function sa(t,e,n){const r=await aa(t).catch((t=>{throw t}));return await pa(r,e,n).catch((t=>{throw t}))}async function aa(t){if(!t)throw new Error("Missing token");t=t.replace(oa,"");const e=Lr.decode(In.decode(t));if(!e||0===e.length||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}function ca(t){return!!t.created_at&&Math.round((new Date).getTime()/1e3)-t.created_at<60}function ua(t){return t.kind===Jo}function la(t,e){const n=t.tags.find((t=>"u"===t[0]));return!!n&&(n.length>0&&n[1]===e)}function fa(t,e){const n=t.tags.find((t=>"method"===t[0]));return!!n&&(n.length>0&&n[1].toLowerCase()===e.toLowerCase())}function ha(t){return Re(Ge(Ur.encode(JSON.stringify(t))))}function da(t,e){const n=t.tags.find((t=>"payload"===t[0]));if(!n)return!1;const r=ha(e);return n.length>0&&n[1]===r}async function pa(t,e,n,r){if(!zr(t))throw new Error("Invalid nostr event, signature invalid");if(!ua(t))throw new Error("Invalid nostr event, kind invalid");if(!ca(t))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!la(t,e))throw new Error("Invalid nostr event, url tag invalid");if(!fa(t,n))throw new Error("Invalid nostr event, method tag invalid");if(Boolean(r)&&"object"==typeof r&&Object.keys(r).length>0&&!da(t,r))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}const ga=["wss://relay.damus.io","wss://nostr.mom/","wss://wot.shaving.kiwi"];function ya(t){l(t,"svelte-mmfah2",'nostr-embed-wrap.svelte-mmfah2{display:flex;flex-direction:column;flex-wrap:nowrap;align-items:flex-start;width:55%;max-width:970px;border:2px lightgray solid;border-radius:15px;padding:15px;background-color:#FFF;background-image:url("data:image/svg+xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0A%3Csvg%20width%3D%228.5287mm%22%20height%3D%228.5287mm%22%20version%3D%221.1%22%20viewBox%3D%220%200%208.5287%208.5287%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20transform%3D%22translate(-104.04%20-19.711)%22%3E%0A%3Cg%20transform%3D%22translate(13.335%20-.25768)%22%20stroke-width%3D%22.041341%22%3E%0A%3Ccircle%20class%3D%22st1%22%20cx%3D%2295.374%22%20cy%3D%2223.032%22%20r%3D%22.50023%22%20fill%3D%22%23fff%22%2F%3E%0A%3Cpath%20class%3D%22st1%22%20d%3D%22m98.388%2023.731c0-1.9554-1.1451-2.8401-2.6624-2.8401-0.678%200-1.2816%200.1819-1.7529%200.51676-0.1571%200.11162-0.37207%200.0041-0.37207-0.18604%200-0.12816-0.10335-0.23564-0.23564-0.23564h-1.3064c-0.12816%200-0.23564%200.10335-0.23564%200.23564v5.9531c0%200.12816%200.10335%200.23564%200.23564%200.23564h1.3932c0.12816%200%200.23151-0.10335%200.23151-0.23151v-0.34726c0-2.5962-1.3725-4.5393-0.01654-4.7956%201.2402-0.23564%202.65-0.12402%202.6665%200.83096%200%200.08268%200.0124%200.33073%200.35553%200.46302%200.20671%200.08268%200.5209%200.10749%200.93431%200.09922%200%200%200.3762-0.02894%200.3762%200.3514%200%200.47542-0.84336%200.44235-0.84336%200.44235-0.27699%200.0124-0.93431-0.06201-1.3105%200.04961-0.19844%200.06201-0.37207%200.17363-0.47542%200.3762-0.17363%200.34313-0.25632%201.0955-0.26872%201.881v0.64079c0%200.12816%200.10335%200.23564%200.23564%200.23564h2.8112c0.12816%200%200.23564-0.10335%200.23564-0.23564v-3.4396z%22%20fill%3D%22%23fff%22%2F%3E%0A%3Cpath%20class%3D%22st2%22%20d%3D%22m99.082%2021.197c-0.1819-0.50436-0.57878-0.90124-1.0831-1.0831-0.45889-0.14469-0.88884-0.14469-1.7446-0.14469h-2.5797c-0.85576%200-1.2857%200-1.7446%200.14469-0.50436%200.1819-0.90124%200.57878-1.0831%201.0831-0.14469%200.46302-0.14469%200.88884-0.14469%201.7446v2.5838c0%200.85576%200%201.2857%200.14469%201.7446%200.1819%200.50436%200.57878%200.90124%201.0831%201.0831%200.46302%200.14469%200.88884%200.14469%201.7446%200.14469h2.5838c0.85576%200%201.2857%200%201.7446-0.14469%200.50436-0.1819%200.90124-0.57878%201.0831-1.0831%200.14469-0.45889%200.14469-0.88884%200.14469-1.7446v-2.5838c0-0.85576%200-1.2857-0.14883-1.7446zm-0.93018%206.2094h-2.8112c-0.12816%200-0.23564-0.10335-0.23564-0.23564v-0.64079c0.0124-0.78548%200.09509-1.5379%200.26872-1.881%200.10335-0.20671%200.27698-0.31833%200.47542-0.3762%200.37207-0.11162%201.0294-0.03721%201.3105-0.04961%200%200%200.84336%200.03307%200.84336-0.44235%200-0.38447-0.3762-0.3514-0.3762-0.3514-0.41341%200.0124-0.73174-0.01654-0.93431-0.09922-0.34313-0.13643-0.35553-0.38034-0.35553-0.46302-0.01654-0.95498-1.4263-1.0707-2.6665-0.83096-1.356%200.25632%200.01654%202.2035%200.01654%204.7956v0.34726c-0.0041%200.12816-0.10335%200.23151-0.23151%200.23151h-1.3973c-0.12816%200-0.23564-0.10335-0.23564-0.23564v-5.9531c0-0.12816%200.10335-0.23564%200.23564-0.23564h1.3105c0.12816%200%200.23564%200.10335%200.23564%200.23564%200%200.1943%200.21497%200.29766%200.37207%200.18604%200.47129-0.339%201.0749-0.51676%201.7529-0.51676%201.5172%200%202.6624%200.8847%202.6624%202.8401v3.4396c-0.0041%200.13229-0.10749%200.23564-0.23978%200.23564zm-3.2825-4.3739c0-0.27699%200.22324-0.50023%200.50023-0.50023s0.50436%200.22324%200.50436%200.50023-0.22324%200.50023-0.50023%200.50023-0.50436-0.21911-0.50436-0.50023z%22%20fill%3D%22%23662482%22%20fill-opacity%3D%22.45%22%2F%3E%0A%3C%2Fg%3E%0A%3C%2Fg%3E%0A%3C%2Fsvg%3E%0A");background-repeat:no-repeat;background-position:right 10px top 10px;background-size:40px}nostr-embed-content.svelte-mmfah2{width:100%}.recursive.svelte-mmfah2{width:95%;background-image:unset}')}function wa(e){let n;return{c(){n=d("p"),n.textContent="Loading..."},m(t,e){f(t,n,e)},p:t,d(t){t&&h(n)}}}function ba(t){let e,n,r,o,i,s,a,c,l=t[1].content+"",y=t[1].created_at+"";return{c(){e=d("nostr-embed-wrap"),n=d("nostr-embed-author"),o=g(),i=d("nostr-embed-content"),s=g(),a=d("nostr-embed-timestemp"),c=p(y),b(n,"pubkey",r=t[1].pubkey),b(i,"class","svelte-mmfah2"),b(e,"class","svelte-mmfah2"),v(e,"recursive",t[0])},m(t,r){f(t,e,r),u(e,n),u(e,o),u(e,i),i.innerHTML=l,u(e,s),u(e,a),u(a,c)},p(t,o){2&o&&r!==(r=t[1].pubkey)&&b(n,"pubkey",r),2&o&&l!==(l=t[1].content+"")&&(i.innerHTML=l),2&o&&y!==(y=t[1].created_at+"")&&m(c,y),1&o&&v(e,"recursive",t[0])},d(t){t&&h(e)}}}function ma(t){let e,n;return{c(){e=d("p"),n=p(t[2]),E(e,"color","red")},m(t,r){f(t,e,r),u(e,n)},p(t,e){4&e&&m(n,t[2])},d(t){t&&h(e)}}}function Ea(e){let n;function r(t,e){return t[2]?ma:t[1]?ba:wa}let o=r(e),i=o(e);return{c(){i.c(),n=y()},m(t,e){i.m(t,e),f(t,n,e)},p(t,[e]){o===(o=r(t))&&i?i.p(t,e):(i.d(1),i=o(t),i&&(i.c(),i.m(n.parentNode,n)))},i:t,o:t,d(t){t&&h(n),i.d(t)}}}function va(t,e,n){let{noteId:r}=e,{recursive:o}=e,i=null,s=null;return r?async function(t){let e,r=ga;if(/^(nevent)/.test(t))try{const{type:n,data:o}=_i.decode(t);"nevent"===n&&(e=o.id,r=[...new Set([...ga,...o.relays])])}catch(t){return console.error("Failed to decode note ID:",t),null}else{if(64!==t.length)return console.error("Invalid code format"),null;e=t}const o=new pn;let s=await o.get(r,{ids:[e]});s.content=await async function(t){if(null==t)return;const e=(t.match(/nostr:(npub1\w+|nprofile1\w+)/g)||[]).map((async t=>({match:t,replacement:"<nostr-embed-mention pubkey='"+t.slice(6)+"'></nostr-embed-mention>"}))),n=await Promise.all(e);let r=t;return n.forEach((({match:t,replacement:e})=>{r=r.replace(t,e)})),r}(s.content),s.content=await async function(t){if(null==t)return;const e=(t.match(/nostr:(nevent\w+)/g)||[]).map((async t=>({match:t,replacement:"<nostr-embed recursive='true' note-id='"+t.slice(6)+"'></nostr-embed>"}))),n=await Promise.all(e);let r=t;return n.forEach((({match:t,replacement:e})=>{r=r.replace(t,e)})),r}(s.content);let a=new Date;a.setTime(1e3*s.created_at),s.created_at=a.toUTCString(),n(1,i=await s)}(r):s="Note ID not passed.",t.$$set=t=>{"noteId"in t&&n(3,r=t.noteId),"recursive"in t&&n(0,o=t.recursive)},[o,i,s,r]}function $a(t){l(t,"svelte-1b6lr67","nostr-embed-author-wrap.svelte-1b6lr67.svelte-1b6lr67{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-start;align-items:center}nostr-embed-author-picture.svelte-1b6lr67.svelte-1b6lr67{width:60px;height:60px;margin-right:10px}nostr-embed-author-picture.svelte-1b6lr67 img.svelte-1b6lr67{width:100%;height:100%;border-radius:50%;object-fit:cover}nostr-embed-author-content.svelte-1b6lr67.svelte-1b6lr67{display:flex;flex-direction:column;align-items:flex-start;flex-wrap:nowrap}nostr-embed-author-name.svelte-1b6lr67.svelte-1b6lr67{font-size:x-large;font-weight:700}")}function xa(e){let n;return{c(){n=d("p"),n.textContent="Author Loading..."},m(t,e){f(t,n,e)},p:t,d(t){t&&h(n)}}}function Aa(t){let e,n,r,o,i,s,a,l,y,E,v,$,x=(t[0].content.display_name||t[0].content.name)+"",A=t[0].content.nip05+"";return{c(){e=d("nostr-embed-author-wrap"),n=d("nostr-embed-author-picture"),r=d("img"),s=g(),a=d("nostr-embed-author-content"),l=d("nostr-embed-author-name"),y=p(x),E=g(),v=d("nostr-embed-author-nip05"),$=p(A),w(r,"alt",o=t[0].content.display_name),c(r.src,i=t[0].content.picture)||w(r,"src",i),w(r,"class","svelte-1b6lr67"),b(n,"class","svelte-1b6lr67"),b(l,"class","svelte-1b6lr67"),b(a,"class","svelte-1b6lr67"),b(e,"class","svelte-1b6lr67")},m(t,o){f(t,e,o),u(e,n),u(n,r),u(e,s),u(e,a),u(a,l),u(l,y),u(a,E),u(a,v),u(v,$)},p(t,e){1&e&&o!==(o=t[0].content.display_name)&&w(r,"alt",o),1&e&&!c(r.src,i=t[0].content.picture)&&w(r,"src",i),1&e&&x!==(x=(t[0].content.display_name||t[0].content.name)+"")&&m(y,x),1&e&&A!==(A=t[0].content.nip05+"")&&m($,A)},d(t){t&&h(e)}}}function ka(t){let e,n;return{c(){e=d("p"),n=p(t[1]),E(e,"color","red")},m(t,r){f(t,e,r),u(e,n)},p(t,e){2&e&&m(n,t[1])},d(t){t&&h(e)}}}function Sa(e){let n;function r(t,e){return t[1]?ka:t[0]?Aa:xa}let o=r(e),i=o(e);return{c(){i.c(),n=y()},m(t,e){i.m(t,e),f(t,n,e)},p(t,[e]){o===(o=r(t))&&i?i.p(t,e):(i.d(1),i=o(t),i&&(i.c(),i.m(n.parentNode,n)))},i:t,o:t,d(t){t&&h(n),i.d(t)}}}function Ba(t,e,n){let{pubkey:r}=e,o=null,i=null;async function s(t){let e,r=ga;if(/^(nprofile|npub)/.test(t))try{const{type:n,data:o}=_i.decode(t);"npub"===n?e=o:"nprofile"===n&&(e=o.pubkey,r=[...new Set([...ga,...o.relays])])}catch(t){return console.error("Failed to decode npub:",t),null}else{if(64!==t.length)return console.error("Invalid code format"),null;e=t}const i=new pn;let s=await i.get(r,{kinds:[0],authors:[e],limit:1});s.content=JSON.parse(s.content),n(0,o=await s)}return r?s(r):i="Author Pubkey not passed.",t.$$set=t=>{"pubkey"in t&&n(2,r=t.pubkey)},[o,i,r,s]}customElements.define("nostr-embed",D(class extends M{constructor(t){super(),C(this,t,va,Ea,i,{noteId:3,recursive:0},ya)}get noteId(){return this.$$.ctx[3]}set noteId(t){this.$$set({noteId:t}),U()}get recursive(){return this.$$.ctx[0]}set recursive(t){this.$$set({recursive:t}),U()}},{noteId:{attribute:"note-id"},recursive:{attribute:"recursive"}},[],[],!0));function _a(e){let n;return{c(){n=d("b"),n.textContent="Mention Loading..."},m(t,e){f(t,n,e)},p:t,d(t){t&&h(n)}}}function Ia(t){let e,n,r=(t[0].content.display_name||t[0].content.name)+"";return{c(){e=d("b"),n=p(r)},m(t,r){f(t,e,r),u(e,n)},p(t,e){1&e&&r!==(r=(t[0].content.display_name||t[0].content.name)+"")&&m(n,r)},d(t){t&&h(e)}}}function Oa(t){let e,n;return{c(){e=d("p"),n=p(t[1]),E(e,"color","red")},m(t,r){f(t,e,r),u(e,n)},p(t,e){2&e&&m(n,t[1])},d(t){t&&h(e)}}}function La(e){let n;function r(t,e){return t[1]?Oa:t[0]?Ia:_a}let o=r(e),i=o(e);return{c(){i.c(),n=y()},m(t,e){i.m(t,e),f(t,n,e)},p(t,[e]){o===(o=r(t))&&i?i.p(t,e):(i.d(1),i=o(t),i&&(i.c(),i.m(n.parentNode,n)))},i:t,o:t,d(t){t&&h(n),i.d(t)}}}function Ua(t,e,n){let{pubkey:r}=e,o=null,i=null;async function s(t){let e,r=ga;if(/^(nprofile|npub)/.test(t))try{const{type:n,data:o}=_i.decode(t);"npub"===n?e=o:"nprofile"===n&&(e=o.pubkey,r=[...new Set([...ga,...o.relays])])}catch(t){return console.error("Failed to decode npub:",t),null}else{if(64!==t.length)return console.error("Invalid code format"),null;e=t}const i=new pn;let s=await i.get(r,{kinds:[0],authors:[e],limit:1});s.content=JSON.parse(s.content),n(0,o=await s)}return r?s(r):i="Author Pubkey not passed.",t.$$set=t=>{"pubkey"in t&&n(2,r=t.pubkey)},[o,i,r,s]}customElements.define("nostr-embed-author",D(class extends M{constructor(t){super(),C(this,t,Ba,Sa,i,{pubkey:2,getProfile:3},$a)}get pubkey(){return this.$$.ctx[2]}set pubkey(t){this.$$set({pubkey:t}),U()}get getProfile(){return this.$$.ctx[3]}},{pubkey:{attribute:"pubkey"}},[],["getProfile"],!0));customElements.define("nostr-embed-mention",D(class extends M{constructor(t){super(),C(this,t,Ua,La,i,{pubkey:2,getProfile:3})}get pubkey(){return this.$$.ctx[2]}set pubkey(t){this.$$set({pubkey:t}),U()}get getProfile(){return this.$$.ctx[3]}},{pubkey:{attribute:"pubkey"}},[],["getProfile"],!0))}();
